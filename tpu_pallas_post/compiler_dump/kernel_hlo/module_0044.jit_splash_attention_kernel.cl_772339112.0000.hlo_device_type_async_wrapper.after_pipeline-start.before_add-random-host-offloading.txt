HloModule jit_splash_attention_kernel, entry_computation_layout={(bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)})->bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}}, allow_spmd_sharding_propagation_to_parameters={true,true,true}, allow_spmd_sharding_propagation_to_output={true}

%_splash_attention.26 (Arg_0.8: s8[1,2,2], Arg_1.9: s8[1,2,2], Arg_2.10: s32[2048], Arg_3.11: s8[1,2,2], Arg_4.12: s8[1,2,2], Arg_5.13: s32[2048], Arg_6.14: s8[1,2,2], Arg_7.15: s8[1,2,2], Arg_8.16: s32[2048], Arg_9.17: bf16[8,2048,128], Arg_10.18: bf16[8,2048,128], Arg_11.19: bf16[8,2048,128]) -> bf16[8,2048,128] {
  %Arg_3.11 = s8[1,2,2]{2,1,0} parameter(3), metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/pjit"}
  %Arg_4.12 = s8[1,2,2]{2,1,0} parameter(4), metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/pjit"}
  %Arg_5.13 = s32[2048]{0} parameter(5), metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/pjit"}
  %Arg_6.14 = s8[1,2,2]{2,1,0} parameter(6), metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/pjit"}
  %Arg_7.15 = s8[1,2,2]{2,1,0} parameter(7), metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/pjit"}
  %Arg_8.16 = s32[2048]{0} parameter(8), metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/pjit"}
  %Arg_0.8 = s8[1,2,2]{2,1,0} parameter(0), metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/pjit"}
  %Arg_1.9 = s8[1,2,2]{2,1,0} parameter(1), metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/pjit"}
  %Arg_9.17 = bf16[8,2048,128]{2,1,0} parameter(9), metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/pjit"}
  %Arg_10.18 = bf16[8,2048,128]{2,1,0} parameter(10), metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/pjit"}
  %Arg_11.19 = bf16[8,2048,128]{2,1,0} parameter(11), metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/pjit"}
  %Arg_2.10 = s32[2048]{0} parameter(2), metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/pjit"}
  %broadcast.20 = s32[2048,128]{1,0} broadcast(%Arg_2.10), dimensions={0}, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/jit(_splash_attention)/broadcast_in_dim" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1045}
  %custom-call.21 = (f32[1024,128]{1,0}, f32[1024,128]{1,0}, f32[1024,128]{1,0}, bf16[8,2048,128]{2,1,0}) custom-call(%Arg_0.8, %Arg_1.9, %Arg_9.17, %Arg_10.18, %Arg_11.19, /*index=5*/%broadcast.20), custom_call_target="tpu_custom_call", operand_layout_constraints={s8[1,2,2]{2,1,0}, s8[1,2,2]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, s32[2048,128]{1,0}}, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/jit(_splash_attention)/splash_mha_fwd_c602b16d/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}, backend_config={"custom_call_config": {"body": "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AwELAwEDAwELAwEDAwELAwEPBAEFCw0NEQEeAwcDERMLAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQMDAQsDAQ8EAQULDQ0RASIDBwMREwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBAwMBCwMBDwQBBQsNDREBJgMHAw8PCwEBAQEBAQcBBwEDAwELAwEDAwELAwEPBAEHAQMLBgMBBQEA6h/hGQsZFQ0qAmUJDR1JDRMLX0ETI2U/JTM1Xx0jISMpMS0LCx8LHR0lGxEpDQkZGRkZGRkZGQsVDQkdCxEVdx1LMwsvHSUlHQ0TLQ1JC0syAhcfGxMbFxcTFy8XFxcXDxkXFRkZJRcZFSMjIxkfDw8NCR0RYnVpbHRpbgBzdGFibGVfbW9zYWljAHRwdQBhcml0aAB2ZWN0b3IAbW9kdWxlAGFyaXRoLmNvbnN0YW50AHZlY3Rvci5sb2FkAGFyaXRoLmluZGV4X2Nhc3QAdmVjdG9yLmJyb2FkY2FzdAB0cHUudmVjdG9yX3N0b3JlAGZ1bmMuZnVuYwBmdW5jLnJldHVybgBhcml0aC5jbXBpAHZlY3Rvci5zaGFwZV9jYXN0AG1lbXJlZi5sb2FkAGFyaXRoLmV4dHNpAHNjZi55aWVsZAB0cHUucmVwZWF0AGFyaXRoLmV4dHVpAHNjZi5pZgBhcml0aC5tdWxmAGFyaXRoLm11bGkAdHB1Lm1hdG11bABhcml0aC5hZGRpAHZlY3Rvci5tdWx0aV9yZWR1Y3Rpb24AYXJpdGguc3ViZgBtYXRoLmV4cABhcml0aC5hZGRmAGFyaXRoLmRpdmYAYXJpdGgudHJ1bmNmAHRwdS5pb3RhAGFyaXRoLnNlbGVjdABhcml0aC5tYXhpbXVtZgBhcml0aC5leHRmAC9ob21lL3B0b3VsbWUvbWluaWNvbmRhMy9lbnZzL3ZsbG0vbGliL3B5dGhvbjMuMTIvc2l0ZS1wYWNrYWdlcy9qYXgvZXhwZXJpbWVudGFsL3BhbGxhcy9vcHMvdHB1L3NwbGFzaF9hdHRlbnRpb24vc3BsYXNoX2F0dGVudGlvbl9rZXJuZWwucHkAZmxhc2hfYXR0ZW50aW9uX2tlcm5lbC48bG9jYWxzPi5ib2R5AC9nZXQAZmxhc2hfYXR0ZW50aW9uX2tlcm5lbC48bG9jYWxzPi5lbmQAdmFsdWUAL2NvbnZlcnRfZWxlbWVudF90eXBlAHN5bV9uYW1lAC9zd2FwAGZ1bmN0aW9uX3R5cGUAL2Jyb2FkY2FzdF9pbl9kaW0AdHJhbnNmb3JtX2luZGljZXMAd2luZG93X2JvdW5kcwBmbGFzaF9hdHRlbnRpb25fa2VybmVsAC9tdWwAX2FwcGx5X21hc2tfYW5kX3NvZnRfY2FwAGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4uaW5pdABfbmV4dF9ub256ZXJvAC9ob21lL3B0b3VsbWUvanVzdGFieXRlL3RwdV9wYWxsYXNfcG9zdC8uL3BhbGxhc19rZXJuZWwucHkAcHJlZGljYXRlAC9yZXBlYXQAL2FkZABwaXBlbGluZV9tb2RlAC9ndAAvY29uZABkaW1lbnNpb24AbWFpbgB0cmFuc2Zvcm1fMAB0cmFuc2Zvcm1fMQB0cmFuc2Zvcm1fMgB0cmFuc2Zvcm1fMwB0cmFuc2Zvcm1fNAB0cmFuc2Zvcm1fNQB0cmFuc2Zvcm1fNgB0cmFuc2Zvcm1fNwAvZXEAdGltZXMAb3BlcmFuZFNlZ21lbnRTaXplcwBzdHJpZGVzAC9kb3RfZ2VuZXJhbABkaW1lbnNpb25fbnVtYmVycwB0cmFuc3Bvc2VfbGhzAHRyYW5zcG9zZV9yaHMAa2luZAByZWR1Y3Rpb25fZGltcwAvc3ViAC9leHAAc3RhYmxlX21vc2FpYy52ZXJzaW9uAHNwbGFzaF9taGFfZndkX2M2MDJiMTZkAGRpbWVuc2lvbl9zZW1hbnRpY3MAaXRlcmF0aW9uX2JvdW5kcwBzY2FsYXJfcHJlZmV0Y2gAc2NyYXRjaF9vcGVyYW5kcwB3aW5kb3dfcGFyYW1zAF9zcGxhc2hfYXR0ZW50aW9uX2ZvcndhcmQuPGxvY2Fscz4udl9pbmRleF9tYXAAX3NwbGFzaF9hdHRlbnRpb25fZm9yd2FyZABfc3BsYXNoX2F0dGVudGlvbl9jdXN0b20AX3NwbGFzaF9hdHRlbnRpb24AU3BsYXNoQXR0ZW50aW9uS2VybmVsLl9fY2FsbF9fAGJlbmNobWFya19rZXJuZWwuPGxvY2Fscz4uc3BsYXNoX2F0dGVudGlvbl9rZXJuZWwAYmVuY2htYXJrX2tlcm5lbAA8bW9kdWxlPgBfbmV4dF9ub256ZXJvLjxsb2NhbHM+LjxsYW1iZGE+AF9zcGxhc2hfYXR0ZW50aW9uX2ZvcndhcmQuPGxvY2Fscz4ua19pbmRleF9tYXAAL2RpdgBmYXN0bWF0aAAvc2NhbgBmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LnJ1bgBvdmVyZmxvd0ZsYWdzAC9pb3RhAC9nZQBDYXVzYWxNYXNrLl9faW5pdF9fLjxsb2NhbHM+LmNhdXNhbF9tYXNrX2Z1bmN0aW9uAC9ob21lL3B0b3VsbWUvbWluaWNvbmRhMy9lbnZzL3ZsbG0vbGliL3B5dGhvbjMuMTIvc2l0ZS1wYWNrYWdlcy9qYXgvZXhwZXJpbWVudGFsL3BhbGxhcy9vcHMvdHB1L3NwbGFzaF9hdHRlbnRpb24vc3BsYXNoX2F0dGVudGlvbl9tYXNrLnB5AC9waml0AC9zZWxlY3RfbgAvcmVkdWNlX21heAAvbWF4AC9yZWR1Y2Vfc3VtAA==", "serialization_format": 1, "needs_layout_passes": true}}
  %get-tuple-element.22 = f32[1024,128]{1,0} get-tuple-element(%custom-call.21), index=0, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/jit(_splash_attention)/splash_mha_fwd_c602b16d/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}
  %get-tuple-element.23 = f32[1024,128]{1,0} get-tuple-element(%custom-call.21), index=1, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/jit(_splash_attention)/splash_mha_fwd_c602b16d/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}
  %get-tuple-element.24 = f32[1024,128]{1,0} get-tuple-element(%custom-call.21), index=2, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/jit(_splash_attention)/splash_mha_fwd_c602b16d/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}
  ROOT %get-tuple-element.25 = bf16[8,2048,128]{2,1,0} get-tuple-element(%custom-call.21), index=3, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b1024_h8_s2048/jit(_splash_attention)/splash_mha_fwd_c602b16d/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}
}

ENTRY %main.28 (Arg_0.1: bf16[8,2048,128], Arg_1.2: bf16[8,2048,128], Arg_2.3: bf16[8,2048,128]) -> bf16[8,2048,128] {
  %constant.4 = s8[1,2,2]{2,1,0} constant({ { { 0, 0 }, { 0, 1 } } })
  %constant.5 = s8[1,2,2]{2,1,0} constant({ { { 1, 0 }, { 2, 1 } } })
  %constant.6 = s32[2048]{0} constant({...})
  %constant.7 = s8[1,2,2]{2,1,0} constant({ { { 0, 0 }, { 1, 1 } } })
  %Arg_0.1 = bf16[8,2048,128]{2,1,0} parameter(0), metadata={op_name="q"}
  %Arg_1.2 = bf16[8,2048,128]{2,1,0} parameter(1), metadata={op_name="k"}
  %Arg_2.3 = bf16[8,2048,128]{2,1,0} parameter(2), metadata={op_name="v"}
  ROOT %call.27 = bf16[8,2048,128]{2,1,0} call(%constant.4, %constant.5, %constant.6, %constant.4, %constant.5, /*index=5*/%constant.6, %constant.7, %constant.5, %constant.6, %Arg_0.1, /*index=10*/%Arg_1.2, %Arg_2.3), to_apply=%_splash_attention.26
}

