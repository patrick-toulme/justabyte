BufferAssignment:
allocation 0: size 512, constant:
 value: <1 constant.5 @0> (size=512,offset=0): s8[1,1,1]{2,1,0:T(4,128)(4,1)}
allocation 1: size 4194304, output shape is |bf16[8,2048,128]|, maybe-live-out:
 value: <10 splash_mha_fwd_08d1d988.1{3} @0> (size=4194304,offset=0): bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}
allocation 2: size 4194304, parameter 0, shape |bf16[8,2048,128]| at ShapeIndex {}:
 value: <2 Arg_0.1 @0> (size=4194304,offset=0): bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}
allocation 3: size 4194304, parameter 1, shape |bf16[8,2048,128]| at ShapeIndex {}:
 value: <3 Arg_1.2 @0> (size=4194304,offset=0): bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}
allocation 4: size 4194304, parameter 2, shape |bf16[8,2048,128]| at ShapeIndex {}:
 value: <4 Arg_2.3 @0> (size=4194304,offset=0): bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}
allocation 5: size 512, constant:
 value: <0 constant.4 @0> (size=512,offset=0): s8[1,1,1]{2,1,0:T(4,128)(4,1)}
allocation 6: size 1048576, color 1, preallocated-temp:
 value: <5 iota.1 @1> (size=1048576,offset=0): s32[2048,128]{1,0:T(8,128)S(1)}
allocation 7: size 3162112, preallocated-temp:
 value: <6 splash_mha_fwd_08d1d988.1{} @0> (size=32,offset=0): (f32[2048,128]{1,0:T(8,128)}, f32[2048,128]{1,0:T(8,128)}, f32[2048,128]{1,0:T(8,128)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)})
 value: <7 splash_mha_fwd_08d1d988.1{0} @0> (size=1048576,offset=16384): f32[2048,128]{1,0:T(8,128)}
 value: <8 splash_mha_fwd_08d1d988.1{1} @0> (size=1048576,offset=1064960): f32[2048,128]{1,0:T(8,128)}
 value: <9 splash_mha_fwd_08d1d988.1{2} @0> (size=1048576,offset=2113536): f32[2048,128]{1,0:T(8,128)}

Total bytes used: 20988928 (20.02MiB)

Used values:
<0 constant.4 @0>
 positions:
  constant.4
 uses:
  splash_mha_fwd_08d1d988.1, operand 0
 from instruction: %constant.4 = s8[1,1,1]{2,1,0:T(4,128)(4,1)} constant({ { {0} } })
<1 constant.5 @0>
 positions:
  constant.5
 uses:
  splash_mha_fwd_08d1d988.1, operand 1
 from instruction: %constant.5 = s8[1,1,1]{2,1,0:T(4,128)(4,1)} constant({ { {1} } })
<2 Arg_0.1 @0>
 positions:
  Arg_0.1
 uses:
  splash_mha_fwd_08d1d988.1, operand 2
 from instruction: %Arg_0.1 = bf16[8,2048,128]{2,1,0:T(8,128)(2,1)} parameter(0), metadata={op_name="q"}
<3 Arg_1.2 @0>
 positions:
  Arg_1.2
 uses:
  splash_mha_fwd_08d1d988.1, operand 3
 from instruction: %Arg_1.2 = bf16[8,2048,128]{2,1,0:T(8,128)(2,1)} parameter(1), metadata={op_name="k"}
<4 Arg_2.3 @0>
 positions:
  Arg_2.3
 uses:
  splash_mha_fwd_08d1d988.1, operand 4
 from instruction: %Arg_2.3 = bf16[8,2048,128]{2,1,0:T(8,128)(2,1)} parameter(2), metadata={op_name="v"}
<5 iota.1 @1>
 positions:
  iota.1
 uses:
  splash_mha_fwd_08d1d988.1, operand 5
 from instruction: %iota.1 = s32[2048,128]{1,0:T(8,128)S(1)} iota(), iota_dimension=0, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b2048_h8_s2048/jit(_splash_attention)/broadcast_in_dim" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1045}
<6 splash_mha_fwd_08d1d988.1{} @0>
 positions:
  splash_mha_fwd_08d1d988.1 {}
 uses:
  get-tuple-element.0, operand 0 {}
 from instruction: %splash_mha_fwd_08d1d988.1 = (f32[2048,128]{1,0:T(8,128)}, f32[2048,128]{1,0:T(8,128)}, f32[2048,128]{1,0:T(8,128)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}) custom-call(%constant.4, %constant.5, %Arg_0.1, %Arg_1.2, %Arg_2.3, /*index=5*/%iota.1), custom_call_target="tpu_custom_call", operand_layout_constraints={s8[1,1,1]{2,1,0}, s8[1,1,1]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, s32[2048,128]{1,0}}, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b2048_h8_s2048/jit(_splash_attention)/splash_mha_fwd_08d1d988/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}, backend_config={"custom_call_config": {"body": "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AQsDAQMDAQsDAQMDAQsDAQ8EAQULDQ0RARoDBwMREwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBAwMBCwMBDwQBBQsNDREBHgMHAxETCwEBAQEBAQcBBwEDAwELAwEDAwELAwEDAwELAwEPBAEFCw0NEQEiAwcDDw8LAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQ8EAQcBAwsGAwEFAQDqH+EZCxkVDSoCZQkNHUkNEwtfQRMjZT8lMzVfHSMhIykxLQsLHwsdHSUbESkNCRkZGRkZGRkZCxUNCR0LERV3HUszCy8dJSUdDRMtDUkLSzICFx8bExsXFxMXLxcXFxcPGRcVGRklFxkVIyMjGR8PDw0JHRFidWlsdGluAHN0YWJsZV9tb3NhaWMAdHB1AGFyaXRoAHZlY3RvcgBtb2R1bGUAYXJpdGguY29uc3RhbnQAdmVjdG9yLmxvYWQAYXJpdGguaW5kZXhfY2FzdAB2ZWN0b3IuYnJvYWRjYXN0AHRwdS52ZWN0b3Jfc3RvcmUAZnVuYy5mdW5jAGZ1bmMucmV0dXJuAGFyaXRoLmNtcGkAdmVjdG9yLnNoYXBlX2Nhc3QAbWVtcmVmLmxvYWQAYXJpdGguZXh0c2kAc2NmLnlpZWxkAHRwdS5yZXBlYXQAYXJpdGguZXh0dWkAc2NmLmlmAGFyaXRoLm11bGYAYXJpdGgubXVsaQB0cHUubWF0bXVsAGFyaXRoLmFkZGkAdmVjdG9yLm11bHRpX3JlZHVjdGlvbgBhcml0aC5zdWJmAG1hdGguZXhwAGFyaXRoLmFkZGYAYXJpdGguZGl2ZgBhcml0aC50cnVuY2YAdHB1LmlvdGEAYXJpdGguc2VsZWN0AGFyaXRoLm1heGltdW1mAGFyaXRoLmV4dGYAL2hvbWUvcHRvdWxtZS9taW5pY29uZGEzL2VudnMvdmxsbS9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL2pheC9leHBlcmltZW50YWwvcGFsbGFzL29wcy90cHUvc3BsYXNoX2F0dGVudGlvbi9zcGxhc2hfYXR0ZW50aW9uX2tlcm5lbC5weQBmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmJvZHkAL2dldABmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmVuZAB2YWx1ZQAvY29udmVydF9lbGVtZW50X3R5cGUAc3ltX25hbWUAL3N3YXAAZnVuY3Rpb25fdHlwZQAvYnJvYWRjYXN0X2luX2RpbQB0cmFuc2Zvcm1faW5kaWNlcwB3aW5kb3dfYm91bmRzAGZsYXNoX2F0dGVudGlvbl9rZXJuZWwAL211bABfYXBwbHlfbWFza19hbmRfc29mdF9jYXAAZmxhc2hfYXR0ZW50aW9uX2tlcm5lbC48bG9jYWxzPi5pbml0AF9uZXh0X25vbnplcm8AL2hvbWUvcHRvdWxtZS9qdXN0YWJ5dGUvdHB1X3BhbGxhc19wb3N0Ly4vcGFsbGFzX2tlcm5lbC5weQBwcmVkaWNhdGUAL3JlcGVhdAAvYWRkAHBpcGVsaW5lX21vZGUAL2d0AC9jb25kAGRpbWVuc2lvbgBtYWluAHRyYW5zZm9ybV8wAHRyYW5zZm9ybV8xAHRyYW5zZm9ybV8yAHRyYW5zZm9ybV8zAHRyYW5zZm9ybV80AHRyYW5zZm9ybV81AHRyYW5zZm9ybV82AHRyYW5zZm9ybV83AC9lcQB0aW1lcwBvcGVyYW5kU2VnbWVudFNpemVzAHN0cmlkZXMAL2RvdF9nZW5lcmFsAGRpbWVuc2lvbl9udW1iZXJzAHRyYW5zcG9zZV9saHMAdHJhbnNwb3NlX3JocwBraW5kAHJlZHVjdGlvbl9kaW1zAC9zdWIAL2V4cABzdGFibGVfbW9zYWljLnZlcnNpb24Ac3BsYXNoX21oYV9md2RfMDhkMWQ5ODgAZGltZW5zaW9uX3NlbWFudGljcwBpdGVyYXRpb25fYm91bmRzAHNjYWxhcl9wcmVmZXRjaABzY3JhdGNoX29wZXJhbmRzAHdpbmRvd19wYXJhbXMAX3NwbGFzaF9hdHRlbnRpb25fZm9yd2FyZC48bG9jYWxzPi52X2luZGV4X21hcABfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkAF9zcGxhc2hfYXR0ZW50aW9uX2N1c3RvbQBfc3BsYXNoX2F0dGVudGlvbgBTcGxhc2hBdHRlbnRpb25LZXJuZWwuX19jYWxsX18AYmVuY2htYXJrX2tlcm5lbC48bG9jYWxzPi5zcGxhc2hfYXR0ZW50aW9uX2tlcm5lbABiZW5jaG1hcmtfa2VybmVsADxtb2R1bGU+AF9uZXh0X25vbnplcm8uPGxvY2Fscz4uPGxhbWJkYT4AX3NwbGFzaF9hdHRlbnRpb25fZm9yd2FyZC48bG9jYWxzPi5rX2luZGV4X21hcAAvZGl2AGZhc3RtYXRoAC9zY2FuAGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4ucnVuAG92ZXJmbG93RmxhZ3MAL2lvdGEAL2dlAENhdXNhbE1hc2suX19pbml0X18uPGxvY2Fscz4uY2F1c2FsX21hc2tfZnVuY3Rpb24AL2hvbWUvcHRvdWxtZS9taW5pY29uZGEzL2VudnMvdmxsbS9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL2pheC9leHBlcmltZW50YWwvcGFsbGFzL29wcy90cHUvc3BsYXNoX2F0dGVudGlvbi9zcGxhc2hfYXR0ZW50aW9uX21hc2sucHkAL3BqaXQAL3NlbGVjdF9uAC9yZWR1Y2VfbWF4AC9tYXgAL3JlZHVjZV9zdW0A", "serialization_format": 1, "needs_layout_passes": true}}
<7 splash_mha_fwd_08d1d988.1{0} @0>
 positions:
  splash_mha_fwd_08d1d988.1 {0}
 uses:
 from instruction: %splash_mha_fwd_08d1d988.1 = (f32[2048,128]{1,0:T(8,128)}, f32[2048,128]{1,0:T(8,128)}, f32[2048,128]{1,0:T(8,128)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}) custom-call(%constant.4, %constant.5, %Arg_0.1, %Arg_1.2, %Arg_2.3, /*index=5*/%iota.1), custom_call_target="tpu_custom_call", operand_layout_constraints={s8[1,1,1]{2,1,0}, s8[1,1,1]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, s32[2048,128]{1,0}}, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b2048_h8_s2048/jit(_splash_attention)/splash_mha_fwd_08d1d988/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}, backend_config={"custom_call_config": {"body": "TUzvUgFNTElSMjEuMC4wZ2l0AAFRCwEDBQcJAQMLAzsNDxETFRcZGx0fISMlJykrLS8xMzU3OTs9P0FDRQMKCWYILwH7BwsXCxMXCxMLCwsbCwsLCycLCxMTExcLCwsLCw8PDw8XGxMTFxNzUwsLExcXFxcXCxMLExMTExMTCxMTExcPCxMTExMTEwsTDxcTCxMTExMPCxcPDxMXCxMXExMTExMPpYUPCwsLCwsLCwsLFxMPExcPExMLExMPExMbCwsFD2GBkY1hKgIqAgFGBgsTExMTFxMXCwsLCxMTExMfFxcLCzMXCwsXExcTExMjCwtrCxsLC3MLDwsLSx8LHwsfCx8LJwsnCycLHwsbGxsbGxsbGw8PDx8LJwsnEwsnEwsnEwsnEwsbEwsbEx8XCx8TEwsfDx8TExMTDw8fDx8TEw8fDwsnExMPDw8TEw8TEx8PEx8PDycTEw8PDxMTDw8fExMfDxMfExMfFx8LExMfCxMTEx8TEx8TExMfExMTHxMTHydTDxMTHxMTH1MTEx8TEx8TEx8TEx8LDwsfExMTHw8LExMfExMfExMfExMfFx8TEx8zExMfExMfExMTHxMXCxMTJx8TExMTExMPExMnExMfDxMTEycXDxcLFxcLIwsXEx8XExMTExMPHxMLEx8PEwsXHwsTEx8rExMTHwsTEx8TExMfFxMTHxcTEx8XHwsTEx8rExMfFxMTHxcTEx8TExMfExMTHxMTHxMTHxMTHxMTEx8XHxMTHzMTExMfExMfExMTHxMTEx8TEx8TExMfExMfExMfExMfExMfExMfBwVZWQkFXUkBLw8HHycHCw8rHwsnFx8jHwcnG0MvKx8fAlIvHwVHAwMTKgMFSRV7WgUDAxMmAwVLFWoEJwVNBU8FUQMDlgRWCAVTBVUFVwVZAwX5BgUSAhYCBVsFXRVXRgMVHgQnHRvWBB2eA6IDBV8FYQVjBWUFZx2jKR2jqR2jDxEBBQMDE+oEAwNeBVoIHQ16BR0NhgUVSgLuBR0NjgcjDQcxAQAAAAAAAAAACAAAAAAAAIAAAAAAAAAAIw0FIQAIAAAAAAAAgAAAAAAAAAANJw0pHQ0uAx0+A0IDHUoDTgMdVgNaAx1iA2YDHW4DcgMFaRVXrgMFax0NygMdDeIDHQ3+Ax0NKgQdDUIEHS9WBAVtHRv6BB0bFgUdGy4FHUIFRgURCwAFbx0bdgcdG4IHHRv+Bx0bGggdGzIIHRtKCAVxHTcyAxXZJx16A34DHTeqAwVzHTfGAwMDZb8dN84DHTfeAxXhJwV1AwNlJgQV7ScVcScdDXIEHYYEigQFdx0NqgQDAxNKBR0NYgUdDW4FHQ0WBhWOBkkdDdIHEQ0RYWZmaW5lX21hcDwoZDAsIGQxLCBkMikgLT4gKGQwLCBkMSwgZDIpPgBhZmZpbmVfbWFwPChkMCwgZDEpIC0+IChkMCwgZDEpPgARDQEFeQV7BX0FfwWBBYMFhQWHBYkdNgM6Ax3HhgMV2WMdl8IDHeYD6gMV4WMdl/oDHekOBAWLAwNlxR0vLgQV7WMdlz4EHelaBAMFrz/3PwWNBY8jdHB1Lm1lbW9yeV9zcGFjZTx2bWVtPgAjdHB1LnBpcGVsaW5lX21vZGU8c3luY2hyb25vdXM+ACN0cHUuZGltZW5zaW9uX3NlbWFudGljczxhcmJpdHJhcnk+ACN0cHUuZGltZW5zaW9uX3NlbWFudGljczxwYXJhbGxlbD4AI3RwdS5tZW1vcnlfc3BhY2U8c21lbT4AI3RwdS5kb3RfZGltZW5zaW9uX251bWJlcnM8WzFdLCBbMV0sIFswXSwgWzBdLCBbMCwgMCwgMSwgMF0sIFtdLCBbXT4AI3RwdS5kb3RfZGltZW5zaW9uX251bWJlcnM8WzFdLCBbMF0sIFswXSwgWzFdLCBbMCwgMCwgMSwgMV0sIFtdLCBbXT4ABZEjAQEBHR/uBB0fCgUdHyIFHToFPgUdMU4FHTICmgUFkwWVBZcFmR0xqgUdMbYFHQfqBR1/CgYDBa8/9yIGAwMTggYdqgauBgWbBZ0jDQMRAQAAAAAAAAAdzgbSBgWfBaEdFgcaBx0fKgcdMgKyBx0fDggdHyYIHR8+CAMFkgK/GZYCBaMFpQMPngKiAh2mAqoCrgKyArYCugLFGce+AsICBacBBwIC//8NJQWpIw0HMQgAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAWrEQ0JBa0FrwERxgLOAtYC3gLmAu4C9gL+AgMFI8oCJU0JyQMFI9ICJU0JywMFI9oCJU0JzQMFI+ICJU8JzwMHjf0j6gIlTwnRAweN/SPyAiVPCdMDB439I/oCJU8J1QMFIwIDJU0J1wMFHVEZyQMFHVEZywMFHVEZzQMFHVMZzwMFHVMZ0QMFHVMZ0wMFHVMZ1QMFHVEZ1xEBAREDARWPkS0DB+YILVsFsS0DCUYPI04PCwWzLQMJMhEdyhELFVlSAwW1LQMJohIT2hIHFVteAwW3LQMJIiQTYiQHFV1qAwW5LQMJriQXyiQLFV92AwW7LWEHgSdPFZOCAwW9LWEHjSNBFduKAy1hB2YCQb0djgOSAwW/LWEH/gIJFR0VmgMVLaYDBcEtAwfeCCtRFZXdLQMH5ggfXRVZsgMVW7YDFV26AxVfvgMVk9sVmZEtAwfmCB9lFZ2RLQMHAgklUR0V1gMVLdoDFZ/dLQMHAgkXUxWPoQXDLQMJJg8jLg8LHRXyAxUt9gMVleMVmaEVnaEdFQYEFS0KBBWf4xUSBCcdLxYELQMHSgsXIx0VKR0vIgQtAwdKCwclEQ0FFY+nLQMJYgtpfgsHHRU2BBUtOgQVle8VmacVnacdFUoEFS1OBBWf7x0VqS0DB5oMBy0VXgQnHS9iBC0DB7oMFz0dFQ8dL24ELQMHugwHPxV2BA8dEXoELQMHwgwRNQMDE4IEEwkQAADgDwXFFY4EDx0RkgQtAwfGDDNBBccdc54EFaIEDx0RpgQtAwfGDBl7Fa4EDx0RsgQtAwfKDCVJHTG6BBW+BA8dEcIELQMHygwlWR0VygQVzgQPHRHSBC0DB8oMI4MV2gQPHRHeBC0DB8oMCR0DBfnmBBICFgIjAQkhAQAAAAEAAAADAAAAAAAAABMJARXyBA8dEfYELQMH5gwzbRX+BA8dEQIFLQMH5gwJLSMBCSEBAAAAAQAAAAIAAAAAAAAAFQ4FDx0REgUtAwfqDDNtFRoFDx0RHgUtAwfqDAktFSYFDx0RKgUtAwfuDDNtFTIFDx0RNgUtAwfuDAktBckVe6kFyy0DB7IMCXERAQJAFVIFCR0HVgUtAweKCyllFXFjBc0VZgUJHQdqBS0DB44LK08VcgUJHQd2BS0DB44LU3cVfgUJHQeCBS0DB54LESUVigUJHQeOBS0DB6oLFTcDAxOWBSURCQAAAAAVngUJHQeiBS0DB7YLE48DBzYCCgI6An0+An0VrgUJHQeyBS0DB/4LI00VugUJHQe+BS0DB/4LU48df8YFFcoFCR0HzgUtAwf+CyOPAwOvPx3aBd4FBc8V4gVJHTPmBS0DCaoJPbIJDy0DBxIME0UVe/IFFXH2BRVX+gUVWf4FFVsCBhVdBgYVX5MVDgZJHTMSBi0DCaoJJ7IJDxUaBkkdMx4GLQMHxgkVOxEBQR1zKgYVLgZJHTMyBi0DCcIJJ8oJDwMDZToGEQ0VHUIGRgYF0RVKBloGHU4GUgYF0y1WBgcCBR89BdUVXgZmBh0zYgYtAwf2CSlzFUoCagYVe24GFXFyBhVXdgYVWXoGFVt+BhVdXxMJkMzMzD8diga7BdcdM5IGLQMHhgoTUR0fux2eBrsF2QMDE6YGJRcJAACA/wXbFbIGCR0HtgYtAwcaDBs5AwVeAl4IYgJmAh0fwgYVxgYJHQfKBi0DBxoMG0sF3RXWBgkdB9oGLQMHIgwbUR1z4gYV5gYJHQfqBi0DB0YMNYcdbgLyBhX2BgkdB/oGLQMHRgwrhx1yAgIHFQYHCR0HCgctAwdGDBuJAwMTEgclFwkAAAAABd8VHgcJHQciBy0DB1IMTXMDBV4CYghiAmYCFS4HCR0HMgctAwdSDBudHW4COgcVPgcJHQdCBy0DB14MKUcdcgJKBxVOBwkdB1IHLQMHXgwZSR0xWgcVXgcJHQdiBy0DB2IMLUkdf2oHFW4HCR0HcgctAwdiDBtJFXoHCR0HfgctAwdmDAktFYYHCR0HigctAwdmDDFVFZIHCR0HlgctAwd2DBU3HRWeBxWiBwkdB6YHLQMHggwRMwMDE64HJQUJAAAAABW2BwkdB7oHLQMHhgwbYQMHNgIOAjoCfT4CfR1zxgcVygcJHQfOBy0DB44MHXsV1gcJHQfaBy0DB5IMQ2MdMeIHFeYHCR0H6gctAweSDC9jHX/yBxX2BwkdB/oHLQMHkgwvdRUCCAkdBwYILQMHkgwJKQMDEz8VEggpHTUWCC0DB1ILM20VHggpHTUiCC0DB1ILCS0VKggpHTUuCC0DB1YLM4MVNggpHTU6CC0DB1YLCS0VQggpHTVGCC0DB1oLM20VTggpHTVSCC0DB1oLCS0jYXJpdGguZmFzdG1hdGg8bm9uZT4AI2FyaXRoLm92ZXJmbG93PG5vbmU+ACN2ZWN0b3Iua2luZDxtYXhpbXVtZj4AI3ZlY3Rvci5raW5kPGFkZD4AAQICAycFAkACBAkXBgIHBQUFE8ELAQkBAgQX+wcFAkACBB/BJwUCQAJACQFBF/sFAkACBAnDJwMCQAknBQJAAgQfJwcFAkACBB8nBQJAAkABBxf7BQJAAgQBwycFAkAFCQUbAQEBBwcPDw8hFRUVDwEFCwEBAQcHBwEBAQULAQEBBwcFAQEnBQJAAgQBJwUCQAJACwRGHQUBEQGOAgcDASUNEQGaAgcDTXcbAQEBAQEBBwEHAQ8BDwEPASEBFQEVARUBDwEDA+cLAwERB+frAwsFBRsdBhoEAwEDHQMDOQsDAREHOaUDCwUfIR8UOQMjCQMfTQMDggJBAwkJBoICAwUDTQMDhwUDAwMDhwUDAwUGhwMFBxdRUwsFhyEJTxdRUwMDhgJWAgMJCQaGAgMFA1cDA4kFAwMDA4kFAwMFBokDBQcTW10LBYkhCVkTW10DA4oCQQMJCQaKAgMFA2EDA4sFAwMDA4sFAwMFBosDBQcVZWcLBYshCWMVZWcZADkDAQUZADkDA20FAwMHBm0DAwMDBwZtAwMDBRUGbQMTCQklJykXBjIEAwEDKwMD8QsDAREH8ZsDCwUtLwMDbwUDAwcGbwMDAwMHBm8DAwMFFQZvAxMJBzM1NxcGRgQDAQM5HQZSBAMBAzEDAzsLAwERBzulAwsFPT8fFDsDQQkDm4oCAwMmAgsDAQMDKgKzAwEjByoCQwMBBU1PAwO1BQMDAwO1BQMDBQa1AwUHE1NVAwO3BQMDAwO3BQMDBQa3AwUHFVlbAwNFBQMDAwNFBQMDAwNFBQMDBQZFAxsJC19hYxMGRQMZA2UDA0cFAwMHBkcDAwNRAwNHBQMDBQZHAxsJDWlrbRMGRwMZA28DAy4CkgUDESUHLgKmBQMRB2dxcwMDQgKzAwEjB0ICQwMBBTt3AwNGArMDASMHRgJDAwEFTXsnB8IFQwMBBXl9NQPWBdIFAx0JBk4CAx0DfycHTgJDAx0Fg4EDA7kFAwMDA7kFAwMFBrkDKwcRh4kbByYGUgIDHQOLEQc+BjYGAy0FjYUDA4YGVgIDCQkGlgYDEQORNwaaBgMRB491kwMDWgKiBgMXKQdaAroGAxcFlZcTBr4GAyMDmQkGagIDBQObOQdqAhcDBQVXnRsH3gZSAgMRA58rB+4GFwMRBZWhLQf+BhcDEQOjAwN2Ag4HAxcpB3YCJgcDFwWlpxMGegIDIwOpCQZ6AgMFA6srBzYHFwMFBVefLQdGBxcDBQOvIQdWBxcDBQWxXS8HZgcXAwUFrbMDA4EFAwMDA4EFAwMFBoEDBQcTt7kLBYEhCZ8Tt7kDA4MFAwMDA4MFAwMFBoMDBQcVvb8LBYMhCbUVvb8DA0sFAwMHBksDAwNRAwNLBQMDBQZLAxsJD8PFxxMGSwMZA8k7BpoHAwUDywMDfgKqBwMFJQd+Ar4HAwUHpc3PGwfCB/UDBQOxAwO9BQMDAwO9BQMDBQa9AwUHF9XXIQfeBxcDBQXT2S8H7gcXAwUF29EDA4UFAwMDA4UFAwMFBoUDBQcX3+ELBYUhCd0X3+EDAyYCCggDARkAOwMBBRkAOwMD8wsDAREH8+sDCwUFQx0GZgQDAQNFAwM9CwMBEQc9pQMLBUdJHxQ9A0sJA0OZAwOrBQMDAwOrBQMDBQarAwUHFU1PAwOtfgQDCQkGrQMFA1MxB60XAwUFVVEbB5oE9QMFA1cDA7EFAwMDA7EFAwMFBrEDBQcXW10hB7YEFwMFBV9ZMwbGBAMZA2EDAysFAwMDAysFAwMDAysFAwMFBisDGwkZZWdpEwYrAxkDaxMGKwMbA2MLBSviBAtvGWVnaQMDGgJBAwkJBhoCAwUDcQMDdQUDAwMDdQUDAwUGdQMFBxN1dwsFdSEJcxN1dwMDHgJBAwkJBh4CAwUDewMDdwUDAwMDdwUDAwUGdwMFBxV/gQsFdyEJfRV/gQMDIgJBAwkJBiICAwUDhQMDeQUDAwMDeQUDAwUGeQMFBxeJiwsFeSEJhxeJixkAPQMBBRkAPQ8AAQ0RAQYDBwMPDwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBDwQBBwEDCw0RAQoDBwMnPwsBAQEBAQEHAQcBAwNpBQMDBwZpAwMDAwcGaQMDAwUVBmkDEwkJCw0PFwbuAwMBAxEDA+ULAwERB+WbAwsFExUDA2sFAwMHBmsDAwMDBwZrAwMDBRUGawMTCQcZGx0XBgIEAwEDHwMDAQsDAQMDAQsDAQ8EAQcBISMNEQEOAwcDJz8LAQEBAQEBBwEHAQMDVQUDAwcGVQMDAwMHBlUDAwMFFQZVAxMJCQsNDxcGlgMDAQMRAwPfCwMBEQffmwMLBRMVAwNnBQMDBwZnAwMDAwcGZwMDAwUVBmcDEwkHGRsdFwbSAwMBAx8DAwELAwEDAwELAwEPBAEHASEjDREBEgMHAw8PCwEBAQEBAQcBBwEDAwELAwEDAwELAwEPBAEFAwsNEQEWAwcDERMLAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQMDAQsDAQ8EAQULDQ0RARoDBwMREwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBAwMBCwMBDwQBBQsNDREBHgMHAxETCwEBAQEBAQcBBwEDAwELAwEDAwELAwEDAwELAwEPBAEFCw0NEQEiAwcDDw8LAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQ8EAQcBAwsGAwEFAQDqH+EZCxkVDSoCZQkNHUkNEwtfQRMjZT8lMzVfHSMhIykxLQsLHwsdHSUbESkNCRkZGRkZGRkZCxUNCR0LERV3HUszCy8dJSUdDRMtDUkLSzICFx8bExsXFxMXLxcXFxcPGRcVGRklFxkVIyMjGR8PDw0JHRFidWlsdGluAHN0YWJsZV9tb3NhaWMAdHB1AGFyaXRoAHZlY3RvcgBtb2R1bGUAYXJpdGguY29uc3RhbnQAdmVjdG9yLmxvYWQAYXJpdGguaW5kZXhfY2FzdAB2ZWN0b3IuYnJvYWRjYXN0AHRwdS52ZWN0b3Jfc3RvcmUAZnVuYy5mdW5jAGZ1bmMucmV0dXJuAGFyaXRoLmNtcGkAdmVjdG9yLnNoYXBlX2Nhc3QAbWVtcmVmLmxvYWQAYXJpdGguZXh0c2kAc2NmLnlpZWxkAHRwdS5yZXBlYXQAYXJpdGguZXh0dWkAc2NmLmlmAGFyaXRoLm11bGYAYXJpdGgubXVsaQB0cHUubWF0bXVsAGFyaXRoLmFkZGkAdmVjdG9yLm11bHRpX3JlZHVjdGlvbgBhcml0aC5zdWJmAG1hdGguZXhwAGFyaXRoLmFkZGYAYXJpdGguZGl2ZgBhcml0aC50cnVuY2YAdHB1LmlvdGEAYXJpdGguc2VsZWN0AGFyaXRoLm1heGltdW1mAGFyaXRoLmV4dGYAL2hvbWUvcHRvdWxtZS9taW5pY29uZGEzL2VudnMvdmxsbS9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL2pheC9leHBlcmltZW50YWwvcGFsbGFzL29wcy90cHUvc3BsYXNoX2F0dGVudGlvbi9zcGxhc2hfYXR0ZW50aW9uX2tlcm5lbC5weQBmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmJvZHkAL2dldABmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmVuZAB2YWx1ZQAvY29udmVydF9lbGVtZW50X3R5cGUAc3ltX25hbWUAL3N3YXAAZnVuY3Rpb25fdHlwZQAvYnJvYWRjYXN0X2luX2RpbQB0cmFuc2Zvcm1faW5kaWNlcwB3aW5kb3dfYm91bmRzAGZsYXNoX2F0dGVudGlvbl9rZXJuZWwAL211bABfYXBwbHlfbWFza19hbmRfc29mdF9jYXAAZmxhc2hfYXR0ZW50aW9uX2tlcm5lbC48bG9jYWxzPi5pbml0AF9uZXh0X25vbnplcm8AL2hvbWUvcHRvdWxtZS9qdXN0YWJ5dGUvdHB1X3BhbGxhc19wb3N0Ly4vcGFsbGFzX2tlcm5lbC5weQBwcmVkaWNhdGUAL3JlcGVhdAAvYWRkAHBpcGVsaW5lX21vZGUAL2d0AC9jb25kAGRpbWVuc2lvbgBtYWluAHRyYW5zZm9ybV8wAHRyYW5zZm9ybV8xAHRyYW5zZm9ybV8yAHRyYW5zZm9ybV8zAHRyYW5zZm9ybV80AHRyYW5zZm9ybV81AHRyYW5zZm9ybV82AHRyYW5zZm9ybV83AC9lcQB0aW1lcwBvcGVyYW5kU2VnbWVudFNpemVzAHN0cmlkZXMAL2RvdF9nZW5lcmFsAGRpbWVuc2lvbl9udW1iZXJzAHRyYW5zcG9zZV9saHMAdHJhbnNwb3NlX3JocwBraW5kAHJlZHVjdGlvbl9kaW1zAC9zdWIAL2V4cABzdGFibGVfbW9zYWljLnZlcnNpb24Ac3BsYXNoX21oYV9md2RfMDhkMWQ5ODgAZGltZW5zaW9uX3NlbWFudGljcwBpdGVyYXRpb25fYm91bmRzAHNjYWxhcl9wcmVmZXRjaABzY3JhdGNoX29wZXJhbmRzAHdpbmRvd19wYXJhbXMAX3NwbGFzaF9hdHRlbnRpb25fZm9yd2FyZC48bG9jYWxzPi52X2luZGV4X21hcABfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkAF9zcGxhc2hfYXR0ZW50aW9uX2N1c3RvbQBfc3BsYXNoX2F0dGVudGlvbgBTcGxhc2hBdHRlbnRpb25LZXJuZWwuX19jYWxsX18AYmVuY2htYXJrX2tlcm5lbC48bG9jYWxzPi5zcGxhc2hfYXR0ZW50aW9uX2tlcm5lbABiZW5jaG1hcmtfa2VybmVsADxtb2R1bGU+AF9uZXh0X25vbnplcm8uPGxvY2Fscz4uPGxhbWJkYT4AX3NwbGFzaF9hdHRlbnRpb25fZm9yd2FyZC48bG9jYWxzPi5rX2luZGV4X21hcAAvZGl2AGZhc3RtYXRoAC9zY2FuAGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4ucnVuAG92ZXJmbG93RmxhZ3MAL2lvdGEAL2dlAENhdXNhbE1hc2suX19pbml0X18uPGxvY2Fscz4uY2F1c2FsX21hc2tfZnVuY3Rpb24AL2hvbWUvcHRvdWxtZS9taW5pY29uZGEzL2VudnMvdmxsbS9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL2pheC9leHBlcmltZW50YWwvcGFsbGFzL29wcy90cHUvc3BsYXNoX2F0dGVudGlvbi9zcGxhc2hfYXR0ZW50aW9uX21hc2sucHkAL3BqaXQAL3NlbGVjdF9uAC9yZWR1Y2VfbWF4AC9tYXgAL3JlZHVjZV9zdW0A", "serialization_format": 1, "needs_layout_passes": true}}
<8 splash_mha_fwd_08d1d988.1{1} @0>
 positions:
  splash_mha_fwd_08d1d988.1 {1}
 uses:
 from instruction: %splash_mha_fwd_08d1d988.1 = (f32[2048,128]{1,0:T(8,128)}, f32[2048,128]{1,0:T(8,128)}, f32[2048,128]{1,0:T(8,128)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}) custom-call(%constant.4, %constant.5, %Arg_0.1, %Arg_1.2, %Arg_2.3, /*index=5*/%iota.1), custom_call_target="tpu_custom_call", operand_layout_constraints={s8[1,1,1]{2,1,0}, s8[1,1,1]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, s32[2048,128]{1,0}}, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b2048_h8_s2048/jit(_splash_attention)/splash_mha_fwd_08d1d988/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}, backend_config={"custom_call_config": {"body": "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AQsDAQMDAQsDAQMDAQsDAQ8EAQULDQ0RARoDBwMREwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBAwMBCwMBDwQBBQsNDREBHgMHAxETCwEBAQEBAQcBBwEDAwELAwEDAwELAwEDAwELAwEPBAEFCw0NEQEiAwcDDw8LAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQ8EAQcBAwsGAwEFAQDqH+EZCxkVDSoCZQkNHUkNEwtfQRMjZT8lMzVfHSMhIykxLQsLHwsdHSUbESkNCRkZGRkZGRkZCxUNCR0LERV3HUszCy8dJSUdDRMtDUkLSzICFx8bExsXFxMXLxcXFxcPGRcVGRklFxkVIyMjGR8PDw0JHRFidWlsdGluAHN0YWJsZV9tb3NhaWMAdHB1AGFyaXRoAHZlY3RvcgBtb2R1bGUAYXJpdGguY29uc3RhbnQAdmVjdG9yLmxvYWQAYXJpdGguaW5kZXhfY2FzdAB2ZWN0b3IuYnJvYWRjYXN0AHRwdS52ZWN0b3Jfc3RvcmUAZnVuYy5mdW5jAGZ1bmMucmV0dXJuAGFyaXRoLmNtcGkAdmVjdG9yLnNoYXBlX2Nhc3QAbWVtcmVmLmxvYWQAYXJpdGguZXh0c2kAc2NmLnlpZWxkAHRwdS5yZXBlYXQAYXJpdGguZXh0dWkAc2NmLmlmAGFyaXRoLm11bGYAYXJpdGgubXVsaQB0cHUubWF0bXVsAGFyaXRoLmFkZGkAdmVjdG9yLm11bHRpX3JlZHVjdGlvbgBhcml0aC5zdWJmAG1hdGguZXhwAGFyaXRoLmFkZGYAYXJpdGguZGl2ZgBhcml0aC50cnVuY2YAdHB1LmlvdGEAYXJpdGguc2VsZWN0AGFyaXRoLm1heGltdW1mAGFyaXRoLmV4dGYAL2hvbWUvcHRvdWxtZS9taW5pY29uZGEzL2VudnMvdmxsbS9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL2pheC9leHBlcmltZW50YWwvcGFsbGFzL29wcy90cHUvc3BsYXNoX2F0dGVudGlvbi9zcGxhc2hfYXR0ZW50aW9uX2tlcm5lbC5weQBmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmJvZHkAL2dldABmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmVuZAB2YWx1ZQAvY29udmVydF9lbGVtZW50X3R5cGUAc3ltX25hbWUAL3N3YXAAZnVuY3Rpb25fdHlwZQAvYnJvYWRjYXN0X2luX2RpbQB0cmFuc2Zvcm1faW5kaWNlcwB3aW5kb3dfYm91bmRzAGZsYXNoX2F0dGVudGlvbl9rZXJuZWwAL211bABfYXBwbHlfbWFza19hbmRfc29mdF9jYXAAZmxhc2hfYXR0ZW50aW9uX2tlcm5lbC48bG9jYWxzPi5pbml0AF9uZXh0X25vbnplcm8AL2hvbWUvcHRvdWxtZS9qdXN0YWJ5dGUvdHB1X3BhbGxhc19wb3N0Ly4vcGFsbGFzX2tlcm5lbC5weQBwcmVkaWNhdGUAL3JlcGVhdAAvYWRkAHBpcGVsaW5lX21vZGUAL2d0AC9jb25kAGRpbWVuc2lvbgBtYWluAHRyYW5zZm9ybV8wAHRyYW5zZm9ybV8xAHRyYW5zZm9ybV8yAHRyYW5zZm9ybV8zAHRyYW5zZm9ybV80AHRyYW5zZm9ybV81AHRyYW5zZm9ybV82AHRyYW5zZm9ybV83AC9lcQB0aW1lcwBvcGVyYW5kU2VnbWVudFNpemVzAHN0cmlkZXMAL2RvdF9nZW5lcmFsAGRpbWVuc2lvbl9udW1iZXJzAHRyYW5zcG9zZV9saHMAdHJhbnNwb3NlX3JocwBraW5kAHJlZHVjdGlvbl9kaW1zAC9zdWIAL2V4cABzdGFibGVfbW9zYWljLnZlcnNpb24Ac3BsYXNoX21oYV9md2RfMDhkMWQ5ODgAZGltZW5zaW9uX3NlbWFudGljcwBpdGVyYXRpb25fYm91bmRzAHNjYWxhcl9wcmVmZXRjaABzY3JhdGNoX29wZXJhbmRzAHdpbmRvd19wYXJhbXMAX3NwbGFzaF9hdHRlbnRpb25fZm9yd2FyZC48bG9jYWxzPi52X2luZGV4X21hcABfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkAF9zcGxhc2hfYXR0ZW50aW9uX2N1c3RvbQBfc3BsYXNoX2F0dGVudGlvbgBTcGxhc2hBdHRlbnRpb25LZXJuZWwuX19jYWxsX18AYmVuY2htYXJrX2tlcm5lbC48bG9jYWxzPi5zcGxhc2hfYXR0ZW50aW9uX2tlcm5lbABiZW5jaG1hcmtfa2VybmVsADxtb2R1bGU+AF9uZXh0X25vbnplcm8uPGxvY2Fscz4uPGxhbWJkYT4AX3NwbGFzaF9hdHRlbnRpb25fZm9yd2FyZC48bG9jYWxzPi5rX2luZGV4X21hcAAvZGl2AGZhc3RtYXRoAC9zY2FuAGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4ucnVuAG92ZXJmbG93RmxhZ3MAL2lvdGEAL2dlAENhdXNhbE1hc2suX19pbml0X18uPGxvY2Fscz4uY2F1c2FsX21hc2tfZnVuY3Rpb24AL2hvbWUvcHRvdWxtZS9taW5pY29uZGEzL2VudnMvdmxsbS9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL2pheC9leHBlcmltZW50YWwvcGFsbGFzL29wcy90cHUvc3BsYXNoX2F0dGVudGlvbi9zcGxhc2hfYXR0ZW50aW9uX21hc2sucHkAL3BqaXQAL3NlbGVjdF9uAC9yZWR1Y2VfbWF4AC9tYXgAL3JlZHVjZV9zdW0A", "serialization_format": 1, "needs_layout_passes": true}}
<9 splash_mha_fwd_08d1d988.1{2} @0>
 positions:
  splash_mha_fwd_08d1d988.1 {2}
 uses:
 from instruction: %splash_mha_fwd_08d1d988.1 = (f32[2048,128]{1,0:T(8,128)}, f32[2048,128]{1,0:T(8,128)}, f32[2048,128]{1,0:T(8,128)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}) custom-call(%constant.4, %constant.5, %Arg_0.1, %Arg_1.2, %Arg_2.3, /*index=5*/%iota.1), custom_call_target="tpu_custom_call", operand_layout_constraints={s8[1,1,1]{2,1,0}, s8[1,1,1]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, s32[2048,128]{1,0}}, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b2048_h8_s2048/jit(_splash_attention)/splash_mha_fwd_08d1d988/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}, backend_config={"custom_call_config": {"body": "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AQsDAQMDAQsDAQMDAQsDAQ8EAQULDQ0RARoDBwMREwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBAwMBCwMBDwQBBQsNDREBHgMHAxETCwEBAQEBAQcBBwEDAwELAwEDAwELAwEDAwELAwEPBAEFCw0NEQEiAwcDDw8LAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQ8EAQcBAwsGAwEFAQDqH+EZCxkVDSoCZQkNHUkNEwtfQRMjZT8lMzVfHSMhIykxLQsLHwsdHSUbESkNCRkZGRkZGRkZCxUNCR0LERV3HUszCy8dJSUdDRMtDUkLSzICFx8bExsXFxMXLxcXFxcPGRcVGRklFxkVIyMjGR8PDw0JHRFidWlsdGluAHN0YWJsZV9tb3NhaWMAdHB1AGFyaXRoAHZlY3RvcgBtb2R1bGUAYXJpdGguY29uc3RhbnQAdmVjdG9yLmxvYWQAYXJpdGguaW5kZXhfY2FzdAB2ZWN0b3IuYnJvYWRjYXN0AHRwdS52ZWN0b3Jfc3RvcmUAZnVuYy5mdW5jAGZ1bmMucmV0dXJuAGFyaXRoLmNtcGkAdmVjdG9yLnNoYXBlX2Nhc3QAbWVtcmVmLmxvYWQAYXJpdGguZXh0c2kAc2NmLnlpZWxkAHRwdS5yZXBlYXQAYXJpdGguZXh0dWkAc2NmLmlmAGFyaXRoLm11bGYAYXJpdGgubXVsaQB0cHUubWF0bXVsAGFyaXRoLmFkZGkAdmVjdG9yLm11bHRpX3JlZHVjdGlvbgBhcml0aC5zdWJmAG1hdGguZXhwAGFyaXRoLmFkZGYAYXJpdGguZGl2ZgBhcml0aC50cnVuY2YAdHB1LmlvdGEAYXJpdGguc2VsZWN0AGFyaXRoLm1heGltdW1mAGFyaXRoLmV4dGYAL2hvbWUvcHRvdWxtZS9taW5pY29uZGEzL2VudnMvdmxsbS9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL2pheC9leHBlcmltZW50YWwvcGFsbGFzL29wcy90cHUvc3BsYXNoX2F0dGVudGlvbi9zcGxhc2hfYXR0ZW50aW9uX2tlcm5lbC5weQBmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmJvZHkAL2dldABmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmVuZAB2YWx1ZQAvY29udmVydF9lbGVtZW50X3R5cGUAc3ltX25hbWUAL3N3YXAAZnVuY3Rpb25fdHlwZQAvYnJvYWRjYXN0X2luX2RpbQB0cmFuc2Zvcm1faW5kaWNlcwB3aW5kb3dfYm91bmRzAGZsYXNoX2F0dGVudGlvbl9rZXJuZWwAL211bABfYXBwbHlfbWFza19hbmRfc29mdF9jYXAAZmxhc2hfYXR0ZW50aW9uX2tlcm5lbC48bG9jYWxzPi5pbml0AF9uZXh0X25vbnplcm8AL2hvbWUvcHRvdWxtZS9qdXN0YWJ5dGUvdHB1X3BhbGxhc19wb3N0Ly4vcGFsbGFzX2tlcm5lbC5weQBwcmVkaWNhdGUAL3JlcGVhdAAvYWRkAHBpcGVsaW5lX21vZGUAL2d0AC9jb25kAGRpbWVuc2lvbgBtYWluAHRyYW5zZm9ybV8wAHRyYW5zZm9ybV8xAHRyYW5zZm9ybV8yAHRyYW5zZm9ybV8zAHRyYW5zZm9ybV80AHRyYW5zZm9ybV81AHRyYW5zZm9ybV82AHRyYW5zZm9ybV83AC9lcQB0aW1lcwBvcGVyYW5kU2VnbWVudFNpemVzAHN0cmlkZXMAL2RvdF9nZW5lcmFsAGRpbWVuc2lvbl9udW1iZXJzAHRyYW5zcG9zZV9saHMAdHJhbnNwb3NlX3JocwBraW5kAHJlZHVjdGlvbl9kaW1zAC9zdWIAL2V4cABzdGFibGVfbW9zYWljLnZlcnNpb24Ac3BsYXNoX21oYV9md2RfMDhkMWQ5ODgAZGltZW5zaW9uX3NlbWFudGljcwBpdGVyYXRpb25fYm91bmRzAHNjYWxhcl9wcmVmZXRjaABzY3JhdGNoX29wZXJhbmRzAHdpbmRvd19wYXJhbXMAX3NwbGFzaF9hdHRlbnRpb25fZm9yd2FyZC48bG9jYWxzPi52X2luZGV4X21hcABfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkAF9zcGxhc2hfYXR0ZW50aW9uX2N1c3RvbQBfc3BsYXNoX2F0dGVudGlvbgBTcGxhc2hBdHRlbnRpb25LZXJuZWwuX19jYWxsX18AYmVuY2htYXJrX2tlcm5lbC48bG9jYWxzPi5zcGxhc2hfYXR0ZW50aW9uX2tlcm5lbABiZW5jaG1hcmtfa2VybmVsADxtb2R1bGU+AF9uZXh0X25vbnplcm8uPGxvY2Fscz4uPGxhbWJkYT4AX3NwbGFzaF9hdHRlbnRpb25fZm9yd2FyZC48bG9jYWxzPi5rX2luZGV4X21hcAAvZGl2AGZhc3RtYXRoAC9zY2FuAGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4ucnVuAG92ZXJmbG93RmxhZ3MAL2lvdGEAL2dlAENhdXNhbE1hc2suX19pbml0X18uPGxvY2Fscz4uY2F1c2FsX21hc2tfZnVuY3Rpb24AL2hvbWUvcHRvdWxtZS9taW5pY29uZGEzL2VudnMvdmxsbS9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL2pheC9leHBlcmltZW50YWwvcGFsbGFzL29wcy90cHUvc3BsYXNoX2F0dGVudGlvbi9zcGxhc2hfYXR0ZW50aW9uX21hc2sucHkAL3BqaXQAL3NlbGVjdF9uAC9yZWR1Y2VfbWF4AC9tYXgAL3JlZHVjZV9zdW0A", "serialization_format": 1, "needs_layout_passes": true}}
<10 splash_mha_fwd_08d1d988.1{3} @0>
 positions:
  splash_mha_fwd_08d1d988.1 {3}
  get-tuple-element.0
 uses:
  get-tuple-element.0, operand 0 {3}
 from instruction: %splash_mha_fwd_08d1d988.1 = (f32[2048,128]{1,0:T(8,128)}, f32[2048,128]{1,0:T(8,128)}, f32[2048,128]{1,0:T(8,128)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}) custom-call(%constant.4, %constant.5, %Arg_0.1, %Arg_1.2, %Arg_2.3, /*index=5*/%iota.1), custom_call_target="tpu_custom_call", operand_layout_constraints={s8[1,1,1]{2,1,0}, s8[1,1,1]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, s32[2048,128]{1,0}}, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b2048_h8_s2048/jit(_splash_attention)/splash_mha_fwd_08d1d988/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}, backend_config={"custom_call_config": {"body": "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AQsDAQMDAQsDAQMDAQsDAQ8EAQULDQ0RARoDBwMREwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBAwMBCwMBDwQBBQsNDREBHgMHAxETCwEBAQEBAQcBBwEDAwELAwEDAwELAwEDAwELAwEPBAEFCw0NEQEiAwcDDw8LAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQ8EAQcBAwsGAwEFAQDqH+EZCxkVDSoCZQkNHUkNEwtfQRMjZT8lMzVfHSMhIykxLQsLHwsdHSUbESkNCRkZGRkZGRkZCxUNCR0LERV3HUszCy8dJSUdDRMtDUkLSzICFx8bExsXFxMXLxcXFxcPGRcVGRklFxkVIyMjGR8PDw0JHRFidWlsdGluAHN0YWJsZV9tb3NhaWMAdHB1AGFyaXRoAHZlY3RvcgBtb2R1bGUAYXJpdGguY29uc3RhbnQAdmVjdG9yLmxvYWQAYXJpdGguaW5kZXhfY2FzdAB2ZWN0b3IuYnJvYWRjYXN0AHRwdS52ZWN0b3Jfc3RvcmUAZnVuYy5mdW5jAGZ1bmMucmV0dXJuAGFyaXRoLmNtcGkAdmVjdG9yLnNoYXBlX2Nhc3QAbWVtcmVmLmxvYWQAYXJpdGguZXh0c2kAc2NmLnlpZWxkAHRwdS5yZXBlYXQAYXJpdGguZXh0dWkAc2NmLmlmAGFyaXRoLm11bGYAYXJpdGgubXVsaQB0cHUubWF0bXVsAGFyaXRoLmFkZGkAdmVjdG9yLm11bHRpX3JlZHVjdGlvbgBhcml0aC5zdWJmAG1hdGguZXhwAGFyaXRoLmFkZGYAYXJpdGguZGl2ZgBhcml0aC50cnVuY2YAdHB1LmlvdGEAYXJpdGguc2VsZWN0AGFyaXRoLm1heGltdW1mAGFyaXRoLmV4dGYAL2hvbWUvcHRvdWxtZS9taW5pY29uZGEzL2VudnMvdmxsbS9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL2pheC9leHBlcmltZW50YWwvcGFsbGFzL29wcy90cHUvc3BsYXNoX2F0dGVudGlvbi9zcGxhc2hfYXR0ZW50aW9uX2tlcm5lbC5weQBmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmJvZHkAL2dldABmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmVuZAB2YWx1ZQAvY29udmVydF9lbGVtZW50X3R5cGUAc3ltX25hbWUAL3N3YXAAZnVuY3Rpb25fdHlwZQAvYnJvYWRjYXN0X2luX2RpbQB0cmFuc2Zvcm1faW5kaWNlcwB3aW5kb3dfYm91bmRzAGZsYXNoX2F0dGVudGlvbl9rZXJuZWwAL211bABfYXBwbHlfbWFza19hbmRfc29mdF9jYXAAZmxhc2hfYXR0ZW50aW9uX2tlcm5lbC48bG9jYWxzPi5pbml0AF9uZXh0X25vbnplcm8AL2hvbWUvcHRvdWxtZS9qdXN0YWJ5dGUvdHB1X3BhbGxhc19wb3N0Ly4vcGFsbGFzX2tlcm5lbC5weQBwcmVkaWNhdGUAL3JlcGVhdAAvYWRkAHBpcGVsaW5lX21vZGUAL2d0AC9jb25kAGRpbWVuc2lvbgBtYWluAHRyYW5zZm9ybV8wAHRyYW5zZm9ybV8xAHRyYW5zZm9ybV8yAHRyYW5zZm9ybV8zAHRyYW5zZm9ybV80AHRyYW5zZm9ybV81AHRyYW5zZm9ybV82AHRyYW5zZm9ybV83AC9lcQB0aW1lcwBvcGVyYW5kU2VnbWVudFNpemVzAHN0cmlkZXMAL2RvdF9nZW5lcmFsAGRpbWVuc2lvbl9udW1iZXJzAHRyYW5zcG9zZV9saHMAdHJhbnNwb3NlX3JocwBraW5kAHJlZHVjdGlvbl9kaW1zAC9zdWIAL2V4cABzdGFibGVfbW9zYWljLnZlcnNpb24Ac3BsYXNoX21oYV9md2RfMDhkMWQ5ODgAZGltZW5zaW9uX3NlbWFudGljcwBpdGVyYXRpb25fYm91bmRzAHNjYWxhcl9wcmVmZXRjaABzY3JhdGNoX29wZXJhbmRzAHdpbmRvd19wYXJhbXMAX3NwbGFzaF9hdHRlbnRpb25fZm9yd2FyZC48bG9jYWxzPi52X2luZGV4X21hcABfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkAF9zcGxhc2hfYXR0ZW50aW9uX2N1c3RvbQBfc3BsYXNoX2F0dGVudGlvbgBTcGxhc2hBdHRlbnRpb25LZXJuZWwuX19jYWxsX18AYmVuY2htYXJrX2tlcm5lbC48bG9jYWxzPi5zcGxhc2hfYXR0ZW50aW9uX2tlcm5lbABiZW5jaG1hcmtfa2VybmVsADxtb2R1bGU+AF9uZXh0X25vbnplcm8uPGxvY2Fscz4uPGxhbWJkYT4AX3NwbGFzaF9hdHRlbnRpb25fZm9yd2FyZC48bG9jYWxzPi5rX2luZGV4X21hcAAvZGl2AGZhc3RtYXRoAC9zY2FuAGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4ucnVuAG92ZXJmbG93RmxhZ3MAL2lvdGEAL2dlAENhdXNhbE1hc2suX19pbml0X18uPGxvY2Fscz4uY2F1c2FsX21hc2tfZnVuY3Rpb24AL2hvbWUvcHRvdWxtZS9taW5pY29uZGEzL2VudnMvdmxsbS9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL2pheC9leHBlcmltZW50YWwvcGFsbGFzL29wcy90cHUvc3BsYXNoX2F0dGVudGlvbi9zcGxhc2hfYXR0ZW50aW9uX21hc2sucHkAL3BqaXQAL3NlbGVjdF9uAC9yZWR1Y2VfbWF4AC9tYXgAL3JlZHVjZV9zdW0A", "serialization_format": 1, "needs_layout_passes": true}}


HloLiveRange (max 8):
  InstructionSequence:
    0:constant.5
    1:constant.4
    2:Arg_2.3
    3:Arg_1.2
    4:Arg_0.1
    5:iota.1
    6:splash_mha_fwd_08d1d988.1
    7:get-tuple-element.0
  BufferLiveRange:
    constant.4{}:1-6
    constant.5{}:0-6
    Arg_0.1{}:0-8
    Arg_1.2{}:0-8
    Arg_2.3{}:0-8
    iota.1{}:5-6
    splash_mha_fwd_08d1d988.1{}:6-7
    splash_mha_fwd_08d1d988.1{0}:6-6
    splash_mha_fwd_08d1d988.1{1}:6-6
    splash_mha_fwd_08d1d988.1{2}:6-6
    splash_mha_fwd_08d1d988.1{3}:6-8
  Live ranges at 6 (peak):
    Arg_0.1{}: 4194304 bytes (cumulative: 4194304 bytes)
    Arg_1.2{}: 4194304 bytes (cumulative: 8388608 bytes)
    Arg_2.3{}: 4194304 bytes (cumulative: 12582912 bytes)
    splash_mha_fwd_08d1d988.1{3}: 4194304 bytes (cumulative: 16777216 bytes)
    iota.1{}: 1048576 bytes (cumulative: 17825792 bytes)
    splash_mha_fwd_08d1d988.1{0}: 1048576 bytes (cumulative: 18874368 bytes)
    splash_mha_fwd_08d1d988.1{1}: 1048576 bytes (cumulative: 19922944 bytes)
    splash_mha_fwd_08d1d988.1{2}: 1048576 bytes (cumulative: 20971520 bytes)
    splash_mha_fwd_08d1d988.1{}: 32 bytes (cumulative: 20971552 bytes)
    constant.4{}: 1 bytes (cumulative: 20971553 bytes)
    constant.5{}: 1 bytes (cumulative: 20971554 bytes)
