BufferAssignment:
allocation 0: size 512, constant:
 value: <1 constant.5 @0> (size=512,offset=0): s8[1,4,4]{2,1,0:T(4,128)(4,1)}
allocation 1: size 4194304, output shape is |bf16[8,2048,128]|, maybe-live-out:
 value: <10 splash_mha_fwd_e9701070.1{3} @0> (size=4194304,offset=0): bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}
allocation 2: size 4194304, parameter 0, shape |bf16[8,2048,128]| at ShapeIndex {}:
 value: <2 Arg_0.1 @0> (size=4194304,offset=0): bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}
allocation 3: size 4194304, parameter 1, shape |bf16[8,2048,128]| at ShapeIndex {}:
 value: <3 Arg_1.2 @0> (size=4194304,offset=0): bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}
allocation 4: size 4194304, parameter 2, shape |bf16[8,2048,128]| at ShapeIndex {}:
 value: <4 Arg_2.3 @0> (size=4194304,offset=0): bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}
allocation 5: size 512, constant:
 value: <0 constant.4 @0> (size=512,offset=0): s8[1,4,4]{2,1,0:T(4,128)(4,1)}
allocation 6: size 1048576, color 1, preallocated-temp:
 value: <5 iota.1 @1> (size=1048576,offset=0): s32[2048,128]{1,0:T(8,128)S(1)}
allocation 7: size 802816, preallocated-temp:
 value: <6 splash_mha_fwd_e9701070.1{} @0> (size=32,offset=0): (f32[512,128]{1,0:T(8,128)}, f32[512,128]{1,0:T(8,128)}, f32[512,128]{1,0:T(8,128)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)})
 value: <7 splash_mha_fwd_e9701070.1{0} @0> (size=262144,offset=16384): f32[512,128]{1,0:T(8,128)}
 value: <8 splash_mha_fwd_e9701070.1{1} @0> (size=262144,offset=278528): f32[512,128]{1,0:T(8,128)}
 value: <9 splash_mha_fwd_e9701070.1{2} @0> (size=262144,offset=540672): f32[512,128]{1,0:T(8,128)}

Total bytes used: 18629632 (17.77MiB)

Used values:
<0 constant.4 @0>
 positions:
  constant.4
 uses:
  splash_mha_fwd_e9701070.1, operand 0
 from instruction: %constant.4 = s8[1,4,4]{2,1,0:T(4,128)(4,1)} constant({...})
<1 constant.5 @0>
 positions:
  constant.5
 uses:
  splash_mha_fwd_e9701070.1, operand 1
 from instruction: %constant.5 = s8[1,4,4]{2,1,0:T(4,128)(4,1)} constant({...})
<2 Arg_0.1 @0>
 positions:
  Arg_0.1
 uses:
  splash_mha_fwd_e9701070.1, operand 2
 from instruction: %Arg_0.1 = bf16[8,2048,128]{2,1,0:T(8,128)(2,1)} parameter(0), metadata={op_name="q"}
<3 Arg_1.2 @0>
 positions:
  Arg_1.2
 uses:
  splash_mha_fwd_e9701070.1, operand 3
 from instruction: %Arg_1.2 = bf16[8,2048,128]{2,1,0:T(8,128)(2,1)} parameter(1), metadata={op_name="k"}
<4 Arg_2.3 @0>
 positions:
  Arg_2.3
 uses:
  splash_mha_fwd_e9701070.1, operand 4
 from instruction: %Arg_2.3 = bf16[8,2048,128]{2,1,0:T(8,128)(2,1)} parameter(2), metadata={op_name="v"}
<5 iota.1 @1>
 positions:
  iota.1
 uses:
  splash_mha_fwd_e9701070.1, operand 5
 from instruction: %iota.1 = s32[2048,128]{1,0:T(8,128)S(1)} iota(), iota_dimension=0, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b512_h8_s2048/jit(_splash_attention)/broadcast_in_dim" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1045}
<6 splash_mha_fwd_e9701070.1{} @0>
 positions:
  splash_mha_fwd_e9701070.1 {}
 uses:
  get-tuple-element.0, operand 0 {}
 from instruction: %splash_mha_fwd_e9701070.1 = (f32[512,128]{1,0:T(8,128)}, f32[512,128]{1,0:T(8,128)}, f32[512,128]{1,0:T(8,128)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}) custom-call(%constant.4, %constant.5, %Arg_0.1, %Arg_1.2, %Arg_2.3, /*index=5*/%iota.1), custom_call_target="tpu_custom_call", operand_layout_constraints={s8[1,4,4]{2,1,0}, s8[1,4,4]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, s32[2048,128]{1,0}}, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b512_h8_s2048/jit(_splash_attention)/splash_mha_fwd_e9701070/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}, backend_config={"custom_call_config": {"body": "TUzvUgFNTElSMjEuMC4wZ2l0AAFRCwEDBQcJAQMLAzsNDxETFRcZGx0fISMlJykrLS8xMzU3OTs9P0FDRQMSCW4ILwH7BwsXCxMXCxMLCwsbCwsLCycLCxMTExcLCwsLCw8PDw8XGxMTFxNzUwsLExcXFxcXCxMLExMTExMTCxMTExcPCxMTExMTEwsTDxcTCxMTExMPCxcPDxMXCxMXExMTExMPpYUPCwsLCwsLCwsLFxMPExcPExMLExMPExMbCwsFD2GBkY1hKgIqAgFOBgsTExMTFxMXCwsLCxMTExMfFxcLCzMXCwsXExcTExMjCwtrCxsLC3MLDwsLSx8LHwsfCx8LJwsnCycLHwsbGxsbGxsbGw8PDx8LJwsnEwsnEwsnEwsnEwsbEwsbEx8XCx8TEwsfDx8TExMTDw8fDx8TEw8fDwsnExMPDw8TEw8TEx8PEx8PDycTEw8PDxMTDw8fFw8TEx8PEx8TEx8XHwsTEx8LExMTHxMTHxMTEx8TExMfExMfJ1MPExMfExMfUxMTHxMTHxMTHxMTHwsPCx8TExMfDwsTEx8TEx8TEx8TEx8XHxMTHzMTEx8TEx8TExMfExcLExMnHxMTExMTEw8TEycTEx8PExMTJxcPFwsXFwsjCxcTHxcTExMTEw8fEwsTHw8TCxcfCxMTHysTExMfCxMTHxMTEx8XExMfFxMTHxcfCxMTHysTEx8XExMfFxMTHxMTEx8TExMfExMfExMfExMfExMTHxcfExMfMxMTEx8TEx8TExMfExMTHxMTHxMTEx8TEx8TEx8TEx8TEx8TEx8HBVlZCQVdSQEvDwcfJwcLDysfCycXHyMfBycbQy8rHx8Cci8fBUcDAxMqAwVJFXtiBQMDEyYDBUsVcgQnBU0FTwVRAwOeBF4IBVMFVQVXBVkDBfkOBRICFgIFWwVdFVdGAxUeBCcdG94EHZ4DogMFXwVhBWMFZQVnHaMpHaOpHaMPEQEFAwMT8gQDA2YFYggdDYIFHQ2OBRVKAvYFHQ2WByMNBzEBAAAAAAAAAAACAAAAAAAAgAAAAAAAAAAjDQUhAAIAAAAAAACAAAAAAAAAAA0nDSkdDS4DHT4DQgMdSgNOAx1WA1oDHWIDZgMdbgNyAwVpFVeuAwVrHQ3KAx0N4gMdDf4DHQ0qBB0NQgQdL1YEBW0dGwIFHRseBR0bNgUdSgVOBRELAAVvHRt+Bx0bigcdGwYIHRsiCB0bOggdG1IIBXEdNzIDFdknHXoDfgMdN6oDBXMdN8YDAwNlvx03zgMdN94DFeEnBXUDA2UmBBXtJxVxJx0NegQdjgSSBAV3HQ2yBAMDE1IFHQ1qBR0NdgUdDR4GFZYGSR0N2gcRDRFhZmZpbmVfbWFwPChkMCwgZDEsIGQyKSAtPiAoZDAsIGQxLCBkMik+AGFmZmluZV9tYXA8KGQwLCBkMSkgLT4gKGQwLCBkMSk+ABENAQV5BXsFfQV/BYEFgwWFBYcFiR02AzoDHceGAxXZYx2XwgMd5gPqAxXhYx2X+gMd6Q4EBYsDA2XFHS8uBBXtYx2XPgQd6WIEAwWvP/c/BY0FjyN0cHUubWVtb3J5X3NwYWNlPHZtZW0+ACN0cHUucGlwZWxpbmVfbW9kZTxzeW5jaHJvbm91cz4AI3RwdS5kaW1lbnNpb25fc2VtYW50aWNzPGFyYml0cmFyeT4AI3RwdS5kaW1lbnNpb25fc2VtYW50aWNzPHBhcmFsbGVsPgAjdHB1Lm1lbW9yeV9zcGFjZTxzbWVtPgAjdHB1LmRvdF9kaW1lbnNpb25fbnVtYmVyczxbMV0sIFsxXSwgWzBdLCBbMF0sIFswLCAwLCAxLCAwXSwgW10sIFtdPgAjdHB1LmRvdF9kaW1lbnNpb25fbnVtYmVyczxbMV0sIFswXSwgWzBdLCBbMV0sIFswLCAwLCAxLCAxXSwgW10sIFtdPgAFkSMBAQEdH/YEHR8SBR0fKgUdQgVGBR0xVgUdMgKiBQWTBZUFlwWZHTGyBR0xvgUdB/IFHX8SBgMFrz/3KgYDAxOKBh2yBrYGBZsFnSMNAxEBAAAAAAAAAB3WBtoGBZ8FoR0eByIHHR8yBx0yAroHHR8WCB0fLggdH0YIAwWSAr8ZlgIFowWlAw+eAqICHaYCqgKuArICtgK6AsUZx74CwgIFpwEHAgL//w0lBakjDQcxCAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABasRDQkFrQWvARHGAs4C1gLeAuYC7gL2Av4CAwUjygIlTQnJAwUj0gIlTQnLAwUj2gIlTQnNAwUj4gIlTwnPAweN/SPqAiVPCdEDB439I/ICJU8J0wMHjf0j+gIlTwnVAwUjAgMlTQnXAwUdURnJAwUdURnLAwUdURnNAwUdUxnPAwUdUxnRAwUdUxnTAwUdUxnVAwUdURnXEQEBEQMBFY+RLQMH5ggtWwWxLQMJRg8jTg8LBbMtAwkyER3KEQsVWVIDBbUtAwmiEhPaEgcVW14DBbctAwkiJBNiJAcVXWoDBbktAwmuJBfKJAsVX3YDBbstYQeBJ08Vk4IDBb0tYQeNI0EV24oDLWEHZgJBvR2OA5IDBb8tYQf+AgkVHRWaAxUtpgMFwS0DB94IK1EVld0tAwfmCB9dFVmyAxVbtgMVXboDFV++AxWT2xWZkS0DB+YIH2UVnZEtAwcCCSVRHRXWAxUt2gMVn90tAwcCCRdTFY+hBcMtAwkmDyMuDwsdFfIDFS32AxWV4xWZoRWdoR0VBgQVLQoEFZ/jFRIEJx0vFgQtAwdKCxcjHRUpHS8iBC0DB0oLByURDQUVj6ctAwliC2l+CwcdFTYEFS06BBWV7xWZpxWdpx0VSgQVLU4EFZ/vHRWpLQMHmgwHLQMDE14EEQENFWYEJx0vagQtAwe6DBc9HRUPHS92BC0DB7oMBz8VfgQPHRGCBC0DB8IMETUDAxOKBBMJEAAA4A8FxRWWBA8dEZoELQMHxgwzQQXHHXOmBBWqBA8dEa4ELQMHxgwZexW2BA8dEboELQMHygwlSR0xwgQVxgQPHRHKBC0DB8oMJVkdFdIEFdYEDx0R2gQtAwfKDCODFeIEDx0R5gQtAwfKDAkdAwX57gQSAhYCIwEJIQEAAAABAAAAAwAAAAAAAAATCQEV+gQPHRH+BC0DB+YMM20VBgUPHREKBS0DB+YMCS0jAQkhAQAAAAEAAAACAAAAAAAAABUWBQ8dERoFLQMH6gwzbRUiBQ8dESYFLQMH6gwJLRUuBQ8dETIFLQMH7gwzbRU6BQ8dET4FLQMH7gwJLQXJFXupBcstAweyDAlxEQECEBVaBQkdB14FLQMHigspZRVxYwXNFW4FCR0HcgUtAweOCytPFXoFCR0HfgUtAweOC1N3FYYFCR0HigUtAweeCxElFZIFCR0HlgUtAweqCxU3AwMTngUlEQkAAAAAFaYFCR0HqgUtAwe2CxOPAwc2AgoCOgJ9PgJ9FbYFCR0HugUtAwf+CyNNFcIFCR0HxgUtAwf+C1OPHX/OBRXSBQkdB9YFLQMH/gsjjwMDrz8d4gXmBQXPFeoFSR0z7gUtAwmqCT2yCQ8tAwcSDBNFFXv6BRVx/gUVVwIGFVkGBhVbCgYVXQ4GFV+TFRYGSR0zGgYtAwmqCSeyCQ8VIgZJHTMmBi0DB8YJFTsRAREdczIGFTYGSR0zOgYtAwnCCSfKCQ8DA2VCBhENFR1KBk4GBdEVUgZiBh1WBloGBdMtXgYHAgUfPQXVFWYGbgYdM2oGLQMH9gkpcxVKAnIGFXt2BhVxegYVV34GFVmCBhVbhgYVXV8TCZDMzMw/HZIGuwXXHTOaBi0DB4YKE1EdH7sdpga7BdkDAxOuBiUXCQAAgP8F2xW6BgkdB74GLQMHGgwbOQMFXgJmCGICZgIdH8oGFc4GCR0H0gYtAwcaDBtLBd0V3gYJHQfiBi0DByIMG1Edc+oGFe4GCR0H8gYtAwdGDDWHHW4C+gYV/gYJHQcCBy0DB0YMK4cdcgIKBxUOBwkdBxIHLQMHRgwbiQMDExoHJRcJAAAAAAXfFSYHCR0HKgctAwdSDE1zAwVeAmoIYgJmAhU2BwkdBzoHLQMHUgwbnR1uAkIHFUYHCR0HSgctAwdeDClHHXICUgcVVgcJHQdaBy0DB14MGUkdMWIHFWYHCR0HagctAwdiDC1JHX9yBxV2BwkdB3oHLQMHYgwbSRWCBwkdB4YHLQMHZgwJLRWOBwkdB5IHLQMHZgwxVRWaBwkdB54HLQMHdgwVNx0VpgcVqgcJHQeuBy0DB4IMETMDAxO2ByUFCQAAAAAVvgcJHQfCBy0DB4YMG2EDBzYCDgI6An0+An0dc84HFdIHCR0H1gctAweODB17Fd4HCR0H4gctAweSDENjHTHqBxXuBwkdB/IHLQMHkgwvYx1/+gcV/gcJHQcCCC0DB5IML3UVCggJHQcOCC0DB5IMCSkDAxM/FRoIKR01HggtAwdSCzNtFSYIKR01KggtAwdSCwktFTIIKR01NggtAwdWCzODFT4IKR01QggtAwdWCwktFUoIKR01TggtAwdaCzNtFVYIKR01WggtAwdaCwktI2FyaXRoLmZhc3RtYXRoPG5vbmU+ACNhcml0aC5vdmVyZmxvdzxub25lPgAjdmVjdG9yLmtpbmQ8bWF4aW11bWY+ACN2ZWN0b3Iua2luZDxhZGQ+AAECAgMnBQIQAgQJFwYCBwURERPBCwEJAQIEF/sHBQIQAgQfwScFAhACEAkBQRf7BQIQAgQJwycDAhAJJwUCEAIEHycHBQIQAgQfJwUCEAIQAQcX+wUCEAIEAcMnBQIQBQkFGwEBAQcHDw8PIRUVFQ8BBQsBAQEHBwcBAQEFCwEBAQcHBQEBJwUCEAIEAScFAhACEAsESh0FAREBjgIHAwElDREBmgIHA013GwEBAQEBAQcBBwEPAQ8BDwEhARUBFQEVAQ8BAwPnCwMBEQfn6wMLBQUbHQYaBAMBAx0DAzkLAwERBzmlAwsFHyEfFDkDIwkDH00DA4ICQQMJCQaCAgMFA00DA4cFAwMDA4cFAwMFBocDBQcXUVMLBYchCU8XUVMDA4YCVgIDCQkGhgIDBQNXAwOJBQMDAwOJBQMDBQaJAwUHE1tdCwWJIQlZE1tdAwOKAkEDCQkGigIDBQNhAwOLBQMDAwOLBQMDBQaLAwUHFWVnCwWLIQljFWVnGQA5AwEFGQA5AwNtBQMDBwZtAwMDAwcGbQMDAwUVBm0DEwkJJScpFwYyBAMBAysDA/ELAwERB/GbAwsFLS8DA28FAwMHBm8DAwMDBwZvAwMDBRUGbwMTCQczNTcXBkYEAwEDOR0GUgQDAQMxAwM7CwMBEQc7pQMLBT0/HxQ7A0EJA5uKAgMDJgILAwEDAyoCswMBIwcqAkMDAQVNTwMDtQUDAwMDtQUDAwUGtQMFBxNTVQMDtwUDAwMDtwUDAwUGtwMFBxVZWwMDRQUDAwMDRQUDAwMDRQUDAwUGRQMbCQtfYWMTBkUDGQNlAwNHBQMDBwZHAwMDUQMDRwUDAwUGRwMbCQ1pa20TBkcDGQNvAwMuApoFAxElBy4CrgUDEQdncXMDA0ICswMBIwdCAkMDAQU7dwMDRgKzAwEjB0YCQwMBBU17JwfKBUMDAQV5fTUD3gXaBQMdCQZOAgMdA38nB04CQwMdBYOBAwO5BQMDAwO5BQMDBQa5AysHEYeJGwcuBlICAx0DixEHRgY+BgMtBY2FAwOOBlYCAwkJBp4GAxEDkTcGogYDEQePdZMDA1oCqgYDFykHWgLCBgMXBZWXEwbGBgMjA5kJBmoCAwUDmzkHagIXAwUFV50bB+YGUgIDEQOfKwf2BhcDEQWVoS0HBgcXAxEDowMDdgIWBwMXKQd2Ai4HAxcFpacTBnoCAyMDqQkGegIDBQOrKwc+BxcDBQVXny0HTgcXAwUDryEHXgcXAwUFsV0vB24HFwMFBa2zAwOBBQMDAwOBBQMDBQaBAwUHE7e5CwWBIQmfE7e5AwODBQMDAwODBQMDBQaDAwUHFb2/CwWDIQm1Fb2/AwNLBQMDBwZLAwMDUQMDSwUDAwUGSwMbCQ/DxccTBksDGQPJOwaiBwMFA8sDA34CsgcDBSUHfgLGBwMFB6XNzxsHygf1AwUDsQMDvQUDAwMDvQUDAwUGvQMFBxfV1yEH5gcXAwUF09kvB/YHFwMFBdvRAwOFBQMDAwOFBQMDBQaFAwUHF9/hCwWFIQndF9/hAwMmAhIIAwEZADsDAQUZADsDA/NaBAMBEQfz6wMLBQVDHQZuBAMBA0UDAz0LAwERBz2lAwsFR0kfFD0DSwkDQ5kDA6sFAwMDA6sFAwMFBqsDBQcVTU8DA62GBAMJCQatAwUDUzEHrRcDBQVVURsHogT1AwUDVwMDsQUDAwMDsQUDAwUGsQMFBxdbXSEHvgQXAwUFX1kzBs4EAxkDYQMDKwUDAwMDKwUDAwMDKwUDAwUGKwMbCRllZ2kTBisDGQNrEwYrAxsDYwsFK+oEC28ZZWdpAwMaAkEDCQkGGgIDBQNxAwN1BQMDAwN1BQMDBQZ1AwUHE3V3CwV1IQlzE3V3AwMeAkEDCQkGHgIDBQN7AwN3BQMDAwN3BQMDBQZ3AwUHFX+BCwV3IQl9FX+BAwMiAkEDCQkGIgIDBQOFAwN5BQMDAwN5BQMDBQZ5AwUHF4mLCwV5IQmHF4mLGQA9AwEFGQA9DwABDREBBgMHAw8PCwEBAQEBAQcBBwEDAwELAwEDAwELAwEPBAEHAQMLDREBCgMHAyc/CwEBAQEBAQcBBwEDA2kFAwMHBmkDAwMDBwZpAwMDBRUGaQMTCQkLDQ8XBu4DAwEDEQMD5QsDAREH5ZsDCwUTFQMDawUDAwcGawMDAwMHBmsDAwMFFQZrAxMJBxkbHRcGAgQDAQMfAwMBCwMBAwMBCwMBDwQBBwEhIw0RAQ4DBwMnPwsBAQEBAQEHAQcBAwNVBQMDBwZVAwMDAwcGVQMDAwUVBlUDEwkJCw0PFwaWAwMBAxEDA98LAwERB9+bAwsFExUDA2cFAwMHBmcDAwMDBwZnAwMDBRUGZwMTCQcZGx0XBtIDAwEDHwMDAQsDAQMDAQsDAQ8EAQcBISMNEQESAwcDDw8LAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQ8EAQUDCw0RARYDBwMREwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBAwMBCwMBDwQBBQsNDREBGgMHAxETCwEBAQEBAQcBBwEDAwELAwEDAwELAwEDAwELAwEPBAEFCw0NEQEeAwcDERMLAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQMDAQsDAQ8EAQULDQ0RASIDBwMPDwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBDwQBBwEDCwYDAQUBAOof4RkLGRUNKgJlCQ0dSQ0TC19BEyNlPyUzNV8dIyEjKTEtCwsfCx0dJRsRKQ0JGRkZGRkZGRkLFQ0JHQsRFXcdSzMLLx0lJR0NEy0NSQtLMgIXHxsTGxcXExcvFxcXFw8ZFxUZGSUXGRUjIyMZHw8PDQkdEWJ1aWx0aW4Ac3RhYmxlX21vc2FpYwB0cHUAYXJpdGgAdmVjdG9yAG1vZHVsZQBhcml0aC5jb25zdGFudAB2ZWN0b3IubG9hZABhcml0aC5pbmRleF9jYXN0AHZlY3Rvci5icm9hZGNhc3QAdHB1LnZlY3Rvcl9zdG9yZQBmdW5jLmZ1bmMAZnVuYy5yZXR1cm4AYXJpdGguY21waQB2ZWN0b3Iuc2hhcGVfY2FzdABtZW1yZWYubG9hZABhcml0aC5leHRzaQBzY2YueWllbGQAdHB1LnJlcGVhdABhcml0aC5leHR1aQBzY2YuaWYAYXJpdGgubXVsZgBhcml0aC5tdWxpAHRwdS5tYXRtdWwAYXJpdGguYWRkaQB2ZWN0b3IubXVsdGlfcmVkdWN0aW9uAGFyaXRoLnN1YmYAbWF0aC5leHAAYXJpdGguYWRkZgBhcml0aC5kaXZmAGFyaXRoLnRydW5jZgB0cHUuaW90YQBhcml0aC5zZWxlY3QAYXJpdGgubWF4aW11bWYAYXJpdGguZXh0ZgAvaG9tZS9wdG91bG1lL21pbmljb25kYTMvZW52cy92bGxtL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvamF4L2V4cGVyaW1lbnRhbC9wYWxsYXMvb3BzL3RwdS9zcGxhc2hfYXR0ZW50aW9uL3NwbGFzaF9hdHRlbnRpb25fa2VybmVsLnB5AGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4uYm9keQAvZ2V0AGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4uZW5kAHZhbHVlAC9jb252ZXJ0X2VsZW1lbnRfdHlwZQBzeW1fbmFtZQAvc3dhcABmdW5jdGlvbl90eXBlAC9icm9hZGNhc3RfaW5fZGltAHRyYW5zZm9ybV9pbmRpY2VzAHdpbmRvd19ib3VuZHMAZmxhc2hfYXR0ZW50aW9uX2tlcm5lbAAvbXVsAF9hcHBseV9tYXNrX2FuZF9zb2Z0X2NhcABmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmluaXQAX25leHRfbm9uemVybwAvaG9tZS9wdG91bG1lL2p1c3RhYnl0ZS90cHVfcGFsbGFzX3Bvc3QvLi9wYWxsYXNfa2VybmVsLnB5AHByZWRpY2F0ZQAvcmVwZWF0AC9hZGQAcGlwZWxpbmVfbW9kZQAvZ3QAL2NvbmQAZGltZW5zaW9uAG1haW4AdHJhbnNmb3JtXzAAdHJhbnNmb3JtXzEAdHJhbnNmb3JtXzIAdHJhbnNmb3JtXzMAdHJhbnNmb3JtXzQAdHJhbnNmb3JtXzUAdHJhbnNmb3JtXzYAdHJhbnNmb3JtXzcAL2VxAHRpbWVzAG9wZXJhbmRTZWdtZW50U2l6ZXMAc3RyaWRlcwAvZG90X2dlbmVyYWwAZGltZW5zaW9uX251bWJlcnMAdHJhbnNwb3NlX2xocwB0cmFuc3Bvc2VfcmhzAGtpbmQAcmVkdWN0aW9uX2RpbXMAL3N1YgAvZXhwAHN0YWJsZV9tb3NhaWMudmVyc2lvbgBzcGxhc2hfbWhhX2Z3ZF9lOTcwMTA3MABkaW1lbnNpb25fc2VtYW50aWNzAGl0ZXJhdGlvbl9ib3VuZHMAc2NhbGFyX3ByZWZldGNoAHNjcmF0Y2hfb3BlcmFuZHMAd2luZG93X3BhcmFtcwBfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkLjxsb2NhbHM+LnZfaW5kZXhfbWFwAF9zcGxhc2hfYXR0ZW50aW9uX2ZvcndhcmQAX3NwbGFzaF9hdHRlbnRpb25fY3VzdG9tAF9zcGxhc2hfYXR0ZW50aW9uAFNwbGFzaEF0dGVudGlvbktlcm5lbC5fX2NhbGxfXwBiZW5jaG1hcmtfa2VybmVsLjxsb2NhbHM+LnNwbGFzaF9hdHRlbnRpb25fa2VybmVsAGJlbmNobWFya19rZXJuZWwAPG1vZHVsZT4AX25leHRfbm9uemVyby48bG9jYWxzPi48bGFtYmRhPgBfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkLjxsb2NhbHM+LmtfaW5kZXhfbWFwAC9kaXYAZmFzdG1hdGgAL3NjYW4AZmxhc2hfYXR0ZW50aW9uX2tlcm5lbC48bG9jYWxzPi5ydW4Ab3ZlcmZsb3dGbGFncwAvaW90YQAvZ2UAQ2F1c2FsTWFzay5fX2luaXRfXy48bG9jYWxzPi5jYXVzYWxfbWFza19mdW5jdGlvbgAvaG9tZS9wdG91bG1lL21pbmljb25kYTMvZW52cy92bGxtL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvamF4L2V4cGVyaW1lbnRhbC9wYWxsYXMvb3BzL3RwdS9zcGxhc2hfYXR0ZW50aW9uL3NwbGFzaF9hdHRlbnRpb25fbWFzay5weQAvcGppdAAvc2VsZWN0X24AL3JlZHVjZV9tYXgAL21heAAvcmVkdWNlX3N1bQA=", "serialization_format": 1, "needs_layout_passes": true}}
<7 splash_mha_fwd_e9701070.1{0} @0>
 positions:
  splash_mha_fwd_e9701070.1 {0}
 uses:
 from instruction: %splash_mha_fwd_e9701070.1 = (f32[512,128]{1,0:T(8,128)}, f32[512,128]{1,0:T(8,128)}, f32[512,128]{1,0:T(8,128)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}) custom-call(%constant.4, %constant.5, %Arg_0.1, %Arg_1.2, %Arg_2.3, /*index=5*/%iota.1), custom_call_target="tpu_custom_call", operand_layout_constraints={s8[1,4,4]{2,1,0}, s8[1,4,4]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, s32[2048,128]{1,0}}, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b512_h8_s2048/jit(_splash_attention)/splash_mha_fwd_e9701070/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}, backend_config={"custom_call_config": {"body": "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AQEBAQEHAQcBAwMBCwMBAwMBCwMBAwMBCwMBDwQBBQsNDREBGgMHAxETCwEBAQEBAQcBBwEDAwELAwEDAwELAwEDAwELAwEPBAEFCw0NEQEeAwcDERMLAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQMDAQsDAQ8EAQULDQ0RASIDBwMPDwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBDwQBBwEDCwYDAQUBAOof4RkLGRUNKgJlCQ0dSQ0TC19BEyNlPyUzNV8dIyEjKTEtCwsfCx0dJRsRKQ0JGRkZGRkZGRkLFQ0JHQsRFXcdSzMLLx0lJR0NEy0NSQtLMgIXHxsTGxcXExcvFxcXFw8ZFxUZGSUXGRUjIyMZHw8PDQkdEWJ1aWx0aW4Ac3RhYmxlX21vc2FpYwB0cHUAYXJpdGgAdmVjdG9yAG1vZHVsZQBhcml0aC5jb25zdGFudAB2ZWN0b3IubG9hZABhcml0aC5pbmRleF9jYXN0AHZlY3Rvci5icm9hZGNhc3QAdHB1LnZlY3Rvcl9zdG9yZQBmdW5jLmZ1bmMAZnVuYy5yZXR1cm4AYXJpdGguY21waQB2ZWN0b3Iuc2hhcGVfY2FzdABtZW1yZWYubG9hZABhcml0aC5leHRzaQBzY2YueWllbGQAdHB1LnJlcGVhdABhcml0aC5leHR1aQBzY2YuaWYAYXJpdGgubXVsZgBhcml0aC5tdWxpAHRwdS5tYXRtdWwAYXJpdGguYWRkaQB2ZWN0b3IubXVsdGlfcmVkdWN0aW9uAGFyaXRoLnN1YmYAbWF0aC5leHAAYXJpdGguYWRkZgBhcml0aC5kaXZmAGFyaXRoLnRydW5jZgB0cHUuaW90YQBhcml0aC5zZWxlY3QAYXJpdGgubWF4aW11bWYAYXJpdGguZXh0ZgAvaG9tZS9wdG91bG1lL21pbmljb25kYTMvZW52cy92bGxtL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvamF4L2V4cGVyaW1lbnRhbC9wYWxsYXMvb3BzL3RwdS9zcGxhc2hfYXR0ZW50aW9uL3NwbGFzaF9hdHRlbnRpb25fa2VybmVsLnB5AGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4uYm9keQAvZ2V0AGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4uZW5kAHZhbHVlAC9jb252ZXJ0X2VsZW1lbnRfdHlwZQBzeW1fbmFtZQAvc3dhcABmdW5jdGlvbl90eXBlAC9icm9hZGNhc3RfaW5fZGltAHRyYW5zZm9ybV9pbmRpY2VzAHdpbmRvd19ib3VuZHMAZmxhc2hfYXR0ZW50aW9uX2tlcm5lbAAvbXVsAF9hcHBseV9tYXNrX2FuZF9zb2Z0X2NhcABmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmluaXQAX25leHRfbm9uemVybwAvaG9tZS9wdG91bG1lL2p1c3RhYnl0ZS90cHVfcGFsbGFzX3Bvc3QvLi9wYWxsYXNfa2VybmVsLnB5AHByZWRpY2F0ZQAvcmVwZWF0AC9hZGQAcGlwZWxpbmVfbW9kZQAvZ3QAL2NvbmQAZGltZW5zaW9uAG1haW4AdHJhbnNmb3JtXzAAdHJhbnNmb3JtXzEAdHJhbnNmb3JtXzIAdHJhbnNmb3JtXzMAdHJhbnNmb3JtXzQAdHJhbnNmb3JtXzUAdHJhbnNmb3JtXzYAdHJhbnNmb3JtXzcAL2VxAHRpbWVzAG9wZXJhbmRTZWdtZW50U2l6ZXMAc3RyaWRlcwAvZG90X2dlbmVyYWwAZGltZW5zaW9uX251bWJlcnMAdHJhbnNwb3NlX2xocwB0cmFuc3Bvc2VfcmhzAGtpbmQAcmVkdWN0aW9uX2RpbXMAL3N1YgAvZXhwAHN0YWJsZV9tb3NhaWMudmVyc2lvbgBzcGxhc2hfbWhhX2Z3ZF9lOTcwMTA3MABkaW1lbnNpb25fc2VtYW50aWNzAGl0ZXJhdGlvbl9ib3VuZHMAc2NhbGFyX3ByZWZldGNoAHNjcmF0Y2hfb3BlcmFuZHMAd2luZG93X3BhcmFtcwBfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkLjxsb2NhbHM+LnZfaW5kZXhfbWFwAF9zcGxhc2hfYXR0ZW50aW9uX2ZvcndhcmQAX3NwbGFzaF9hdHRlbnRpb25fY3VzdG9tAF9zcGxhc2hfYXR0ZW50aW9uAFNwbGFzaEF0dGVudGlvbktlcm5lbC5fX2NhbGxfXwBiZW5jaG1hcmtfa2VybmVsLjxsb2NhbHM+LnNwbGFzaF9hdHRlbnRpb25fa2VybmVsAGJlbmNobWFya19rZXJuZWwAPG1vZHVsZT4AX25leHRfbm9uemVyby48bG9jYWxzPi48bGFtYmRhPgBfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkLjxsb2NhbHM+LmtfaW5kZXhfbWFwAC9kaXYAZmFzdG1hdGgAL3NjYW4AZmxhc2hfYXR0ZW50aW9uX2tlcm5lbC48bG9jYWxzPi5ydW4Ab3ZlcmZsb3dGbGFncwAvaW90YQAvZ2UAQ2F1c2FsTWFzay5fX2luaXRfXy48bG9jYWxzPi5jYXVzYWxfbWFza19mdW5jdGlvbgAvaG9tZS9wdG91bG1lL21pbmljb25kYTMvZW52cy92bGxtL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvamF4L2V4cGVyaW1lbnRhbC9wYWxsYXMvb3BzL3RwdS9zcGxhc2hfYXR0ZW50aW9uL3NwbGFzaF9hdHRlbnRpb25fbWFzay5weQAvcGppdAAvc2VsZWN0X24AL3JlZHVjZV9tYXgAL21heAAvcmVkdWNlX3N1bQA=", "serialization_format": 1, "needs_layout_passes": true}}
<8 splash_mha_fwd_e9701070.1{1} @0>
 positions:
  splash_mha_fwd_e9701070.1 {1}
 uses:
 from instruction: %splash_mha_fwd_e9701070.1 = (f32[512,128]{1,0:T(8,128)}, f32[512,128]{1,0:T(8,128)}, f32[512,128]{1,0:T(8,128)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}) custom-call(%constant.4, %constant.5, %Arg_0.1, %Arg_1.2, %Arg_2.3, /*index=5*/%iota.1), custom_call_target="tpu_custom_call", operand_layout_constraints={s8[1,4,4]{2,1,0}, s8[1,4,4]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, s32[2048,128]{1,0}}, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b512_h8_s2048/jit(_splash_attention)/splash_mha_fwd_e9701070/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}, backend_config={"custom_call_config": {"body": "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AQEBAQEHAQcBAwMBCwMBAwMBCwMBAwMBCwMBDwQBBQsNDREBGgMHAxETCwEBAQEBAQcBBwEDAwELAwEDAwELAwEDAwELAwEPBAEFCw0NEQEeAwcDERMLAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQMDAQsDAQ8EAQULDQ0RASIDBwMPDwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBDwQBBwEDCwYDAQUBAOof4RkLGRUNKgJlCQ0dSQ0TC19BEyNlPyUzNV8dIyEjKTEtCwsfCx0dJRsRKQ0JGRkZGRkZGRkLFQ0JHQsRFXcdSzMLLx0lJR0NEy0NSQtLMgIXHxsTGxcXExcvFxcXFw8ZFxUZGSUXGRUjIyMZHw8PDQkdEWJ1aWx0aW4Ac3RhYmxlX21vc2FpYwB0cHUAYXJpdGgAdmVjdG9yAG1vZHVsZQBhcml0aC5jb25zdGFudAB2ZWN0b3IubG9hZABhcml0aC5pbmRleF9jYXN0AHZlY3Rvci5icm9hZGNhc3QAdHB1LnZlY3Rvcl9zdG9yZQBmdW5jLmZ1bmMAZnVuYy5yZXR1cm4AYXJpdGguY21waQB2ZWN0b3Iuc2hhcGVfY2FzdABtZW1yZWYubG9hZABhcml0aC5leHRzaQBzY2YueWllbGQAdHB1LnJlcGVhdABhcml0aC5leHR1aQBzY2YuaWYAYXJpdGgubXVsZgBhcml0aC5tdWxpAHRwdS5tYXRtdWwAYXJpdGguYWRkaQB2ZWN0b3IubXVsdGlfcmVkdWN0aW9uAGFyaXRoLnN1YmYAbWF0aC5leHAAYXJpdGguYWRkZgBhcml0aC5kaXZmAGFyaXRoLnRydW5jZgB0cHUuaW90YQBhcml0aC5zZWxlY3QAYXJpdGgubWF4aW11bWYAYXJpdGguZXh0ZgAvaG9tZS9wdG91bG1lL21pbmljb25kYTMvZW52cy92bGxtL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvamF4L2V4cGVyaW1lbnRhbC9wYWxsYXMvb3BzL3RwdS9zcGxhc2hfYXR0ZW50aW9uL3NwbGFzaF9hdHRlbnRpb25fa2VybmVsLnB5AGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4uYm9keQAvZ2V0AGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4uZW5kAHZhbHVlAC9jb252ZXJ0X2VsZW1lbnRfdHlwZQBzeW1fbmFtZQAvc3dhcABmdW5jdGlvbl90eXBlAC9icm9hZGNhc3RfaW5fZGltAHRyYW5zZm9ybV9pbmRpY2VzAHdpbmRvd19ib3VuZHMAZmxhc2hfYXR0ZW50aW9uX2tlcm5lbAAvbXVsAF9hcHBseV9tYXNrX2FuZF9zb2Z0X2NhcABmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmluaXQAX25leHRfbm9uemVybwAvaG9tZS9wdG91bG1lL2p1c3RhYnl0ZS90cHVfcGFsbGFzX3Bvc3QvLi9wYWxsYXNfa2VybmVsLnB5AHByZWRpY2F0ZQAvcmVwZWF0AC9hZGQAcGlwZWxpbmVfbW9kZQAvZ3QAL2NvbmQAZGltZW5zaW9uAG1haW4AdHJhbnNmb3JtXzAAdHJhbnNmb3JtXzEAdHJhbnNmb3JtXzIAdHJhbnNmb3JtXzMAdHJhbnNmb3JtXzQAdHJhbnNmb3JtXzUAdHJhbnNmb3JtXzYAdHJhbnNmb3JtXzcAL2VxAHRpbWVzAG9wZXJhbmRTZWdtZW50U2l6ZXMAc3RyaWRlcwAvZG90X2dlbmVyYWwAZGltZW5zaW9uX251bWJlcnMAdHJhbnNwb3NlX2xocwB0cmFuc3Bvc2VfcmhzAGtpbmQAcmVkdWN0aW9uX2RpbXMAL3N1YgAvZXhwAHN0YWJsZV9tb3NhaWMudmVyc2lvbgBzcGxhc2hfbWhhX2Z3ZF9lOTcwMTA3MABkaW1lbnNpb25fc2VtYW50aWNzAGl0ZXJhdGlvbl9ib3VuZHMAc2NhbGFyX3ByZWZldGNoAHNjcmF0Y2hfb3BlcmFuZHMAd2luZG93X3BhcmFtcwBfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkLjxsb2NhbHM+LnZfaW5kZXhfbWFwAF9zcGxhc2hfYXR0ZW50aW9uX2ZvcndhcmQAX3NwbGFzaF9hdHRlbnRpb25fY3VzdG9tAF9zcGxhc2hfYXR0ZW50aW9uAFNwbGFzaEF0dGVudGlvbktlcm5lbC5fX2NhbGxfXwBiZW5jaG1hcmtfa2VybmVsLjxsb2NhbHM+LnNwbGFzaF9hdHRlbnRpb25fa2VybmVsAGJlbmNobWFya19rZXJuZWwAPG1vZHVsZT4AX25leHRfbm9uemVyby48bG9jYWxzPi48bGFtYmRhPgBfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkLjxsb2NhbHM+LmtfaW5kZXhfbWFwAC9kaXYAZmFzdG1hdGgAL3NjYW4AZmxhc2hfYXR0ZW50aW9uX2tlcm5lbC48bG9jYWxzPi5ydW4Ab3ZlcmZsb3dGbGFncwAvaW90YQAvZ2UAQ2F1c2FsTWFzay5fX2luaXRfXy48bG9jYWxzPi5jYXVzYWxfbWFza19mdW5jdGlvbgAvaG9tZS9wdG91bG1lL21pbmljb25kYTMvZW52cy92bGxtL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvamF4L2V4cGVyaW1lbnRhbC9wYWxsYXMvb3BzL3RwdS9zcGxhc2hfYXR0ZW50aW9uL3NwbGFzaF9hdHRlbnRpb25fbWFzay5weQAvcGppdAAvc2VsZWN0X24AL3JlZHVjZV9tYXgAL21heAAvcmVkdWNlX3N1bQA=", "serialization_format": 1, "needs_layout_passes": true}}
<9 splash_mha_fwd_e9701070.1{2} @0>
 positions:
  splash_mha_fwd_e9701070.1 {2}
 uses:
 from instruction: %splash_mha_fwd_e9701070.1 = (f32[512,128]{1,0:T(8,128)}, f32[512,128]{1,0:T(8,128)}, f32[512,128]{1,0:T(8,128)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}) custom-call(%constant.4, %constant.5, %Arg_0.1, %Arg_1.2, %Arg_2.3, /*index=5*/%iota.1), custom_call_target="tpu_custom_call", operand_layout_constraints={s8[1,4,4]{2,1,0}, s8[1,4,4]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, s32[2048,128]{1,0}}, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b512_h8_s2048/jit(_splash_attention)/splash_mha_fwd_e9701070/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}, backend_config={"custom_call_config": {"body": "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AQEBAQEHAQcBAwMBCwMBAwMBCwMBAwMBCwMBDwQBBQsNDREBGgMHAxETCwEBAQEBAQcBBwEDAwELAwEDAwELAwEDAwELAwEPBAEFCw0NEQEeAwcDERMLAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQMDAQsDAQ8EAQULDQ0RASIDBwMPDwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBDwQBBwEDCwYDAQUBAOof4RkLGRUNKgJlCQ0dSQ0TC19BEyNlPyUzNV8dIyEjKTEtCwsfCx0dJRsRKQ0JGRkZGRkZGRkLFQ0JHQsRFXcdSzMLLx0lJR0NEy0NSQtLMgIXHxsTGxcXExcvFxcXFw8ZFxUZGSUXGRUjIyMZHw8PDQkdEWJ1aWx0aW4Ac3RhYmxlX21vc2FpYwB0cHUAYXJpdGgAdmVjdG9yAG1vZHVsZQBhcml0aC5jb25zdGFudAB2ZWN0b3IubG9hZABhcml0aC5pbmRleF9jYXN0AHZlY3Rvci5icm9hZGNhc3QAdHB1LnZlY3Rvcl9zdG9yZQBmdW5jLmZ1bmMAZnVuYy5yZXR1cm4AYXJpdGguY21waQB2ZWN0b3Iuc2hhcGVfY2FzdABtZW1yZWYubG9hZABhcml0aC5leHRzaQBzY2YueWllbGQAdHB1LnJlcGVhdABhcml0aC5leHR1aQBzY2YuaWYAYXJpdGgubXVsZgBhcml0aC5tdWxpAHRwdS5tYXRtdWwAYXJpdGguYWRkaQB2ZWN0b3IubXVsdGlfcmVkdWN0aW9uAGFyaXRoLnN1YmYAbWF0aC5leHAAYXJpdGguYWRkZgBhcml0aC5kaXZmAGFyaXRoLnRydW5jZgB0cHUuaW90YQBhcml0aC5zZWxlY3QAYXJpdGgubWF4aW11bWYAYXJpdGguZXh0ZgAvaG9tZS9wdG91bG1lL21pbmljb25kYTMvZW52cy92bGxtL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvamF4L2V4cGVyaW1lbnRhbC9wYWxsYXMvb3BzL3RwdS9zcGxhc2hfYXR0ZW50aW9uL3NwbGFzaF9hdHRlbnRpb25fa2VybmVsLnB5AGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4uYm9keQAvZ2V0AGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4uZW5kAHZhbHVlAC9jb252ZXJ0X2VsZW1lbnRfdHlwZQBzeW1fbmFtZQAvc3dhcABmdW5jdGlvbl90eXBlAC9icm9hZGNhc3RfaW5fZGltAHRyYW5zZm9ybV9pbmRpY2VzAHdpbmRvd19ib3VuZHMAZmxhc2hfYXR0ZW50aW9uX2tlcm5lbAAvbXVsAF9hcHBseV9tYXNrX2FuZF9zb2Z0X2NhcABmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmluaXQAX25leHRfbm9uemVybwAvaG9tZS9wdG91bG1lL2p1c3RhYnl0ZS90cHVfcGFsbGFzX3Bvc3QvLi9wYWxsYXNfa2VybmVsLnB5AHByZWRpY2F0ZQAvcmVwZWF0AC9hZGQAcGlwZWxpbmVfbW9kZQAvZ3QAL2NvbmQAZGltZW5zaW9uAG1haW4AdHJhbnNmb3JtXzAAdHJhbnNmb3JtXzEAdHJhbnNmb3JtXzIAdHJhbnNmb3JtXzMAdHJhbnNmb3JtXzQAdHJhbnNmb3JtXzUAdHJhbnNmb3JtXzYAdHJhbnNmb3JtXzcAL2VxAHRpbWVzAG9wZXJhbmRTZWdtZW50U2l6ZXMAc3RyaWRlcwAvZG90X2dlbmVyYWwAZGltZW5zaW9uX251bWJlcnMAdHJhbnNwb3NlX2xocwB0cmFuc3Bvc2VfcmhzAGtpbmQAcmVkdWN0aW9uX2RpbXMAL3N1YgAvZXhwAHN0YWJsZV9tb3NhaWMudmVyc2lvbgBzcGxhc2hfbWhhX2Z3ZF9lOTcwMTA3MABkaW1lbnNpb25fc2VtYW50aWNzAGl0ZXJhdGlvbl9ib3VuZHMAc2NhbGFyX3ByZWZldGNoAHNjcmF0Y2hfb3BlcmFuZHMAd2luZG93X3BhcmFtcwBfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkLjxsb2NhbHM+LnZfaW5kZXhfbWFwAF9zcGxhc2hfYXR0ZW50aW9uX2ZvcndhcmQAX3NwbGFzaF9hdHRlbnRpb25fY3VzdG9tAF9zcGxhc2hfYXR0ZW50aW9uAFNwbGFzaEF0dGVudGlvbktlcm5lbC5fX2NhbGxfXwBiZW5jaG1hcmtfa2VybmVsLjxsb2NhbHM+LnNwbGFzaF9hdHRlbnRpb25fa2VybmVsAGJlbmNobWFya19rZXJuZWwAPG1vZHVsZT4AX25leHRfbm9uemVyby48bG9jYWxzPi48bGFtYmRhPgBfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkLjxsb2NhbHM+LmtfaW5kZXhfbWFwAC9kaXYAZmFzdG1hdGgAL3NjYW4AZmxhc2hfYXR0ZW50aW9uX2tlcm5lbC48bG9jYWxzPi5ydW4Ab3ZlcmZsb3dGbGFncwAvaW90YQAvZ2UAQ2F1c2FsTWFzay5fX2luaXRfXy48bG9jYWxzPi5jYXVzYWxfbWFza19mdW5jdGlvbgAvaG9tZS9wdG91bG1lL21pbmljb25kYTMvZW52cy92bGxtL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvamF4L2V4cGVyaW1lbnRhbC9wYWxsYXMvb3BzL3RwdS9zcGxhc2hfYXR0ZW50aW9uL3NwbGFzaF9hdHRlbnRpb25fbWFzay5weQAvcGppdAAvc2VsZWN0X24AL3JlZHVjZV9tYXgAL21heAAvcmVkdWNlX3N1bQA=", "serialization_format": 1, "needs_layout_passes": true}}
<10 splash_mha_fwd_e9701070.1{3} @0>
 positions:
  splash_mha_fwd_e9701070.1 {3}
  get-tuple-element.0
 uses:
  get-tuple-element.0, operand 0 {3}
 from instruction: %splash_mha_fwd_e9701070.1 = (f32[512,128]{1,0:T(8,128)}, f32[512,128]{1,0:T(8,128)}, f32[512,128]{1,0:T(8,128)}, bf16[8,2048,128]{2,1,0:T(8,128)(2,1)}) custom-call(%constant.4, %constant.5, %Arg_0.1, %Arg_1.2, %Arg_2.3, /*index=5*/%iota.1), custom_call_target="tpu_custom_call", operand_layout_constraints={s8[1,4,4]{2,1,0}, s8[1,4,4]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, bf16[8,2048,128]{2,1,0}, s32[2048,128]{1,0}}, metadata={op_name="jit(splash_attention_kernel)/jit(main)/splash_attention_kernel/splash_kernel_b512_h8_s2048/jit(_splash_attention)/splash_mha_fwd_e9701070/pallas_call" source_file="/home/ptoulme/miniconda3/envs/vllm/lib/python3.12/site-packages/jax/experimental/pallas/ops/tpu/splash_attention/splash_attention_kernel.py" source_line=1100}, backend_config={"custom_call_config": {"body": "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AQEBAQEHAQcBAwMBCwMBAwMBCwMBAwMBCwMBDwQBBQsNDREBGgMHAxETCwEBAQEBAQcBBwEDAwELAwEDAwELAwEDAwELAwEPBAEFCw0NEQEeAwcDERMLAQEBAQEBBwEHAQMDAQsDAQMDAQsDAQMDAQsDAQ8EAQULDQ0RASIDBwMPDwsBAQEBAQEHAQcBAwMBCwMBAwMBCwMBDwQBBwEDCwYDAQUBAOof4RkLGRUNKgJlCQ0dSQ0TC19BEyNlPyUzNV8dIyEjKTEtCwsfCx0dJRsRKQ0JGRkZGRkZGRkLFQ0JHQsRFXcdSzMLLx0lJR0NEy0NSQtLMgIXHxsTGxcXExcvFxcXFw8ZFxUZGSUXGRUjIyMZHw8PDQkdEWJ1aWx0aW4Ac3RhYmxlX21vc2FpYwB0cHUAYXJpdGgAdmVjdG9yAG1vZHVsZQBhcml0aC5jb25zdGFudAB2ZWN0b3IubG9hZABhcml0aC5pbmRleF9jYXN0AHZlY3Rvci5icm9hZGNhc3QAdHB1LnZlY3Rvcl9zdG9yZQBmdW5jLmZ1bmMAZnVuYy5yZXR1cm4AYXJpdGguY21waQB2ZWN0b3Iuc2hhcGVfY2FzdABtZW1yZWYubG9hZABhcml0aC5leHRzaQBzY2YueWllbGQAdHB1LnJlcGVhdABhcml0aC5leHR1aQBzY2YuaWYAYXJpdGgubXVsZgBhcml0aC5tdWxpAHRwdS5tYXRtdWwAYXJpdGguYWRkaQB2ZWN0b3IubXVsdGlfcmVkdWN0aW9uAGFyaXRoLnN1YmYAbWF0aC5leHAAYXJpdGguYWRkZgBhcml0aC5kaXZmAGFyaXRoLnRydW5jZgB0cHUuaW90YQBhcml0aC5zZWxlY3QAYXJpdGgubWF4aW11bWYAYXJpdGguZXh0ZgAvaG9tZS9wdG91bG1lL21pbmljb25kYTMvZW52cy92bGxtL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvamF4L2V4cGVyaW1lbnRhbC9wYWxsYXMvb3BzL3RwdS9zcGxhc2hfYXR0ZW50aW9uL3NwbGFzaF9hdHRlbnRpb25fa2VybmVsLnB5AGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4uYm9keQAvZ2V0AGZsYXNoX2F0dGVudGlvbl9rZXJuZWwuPGxvY2Fscz4uZW5kAHZhbHVlAC9jb252ZXJ0X2VsZW1lbnRfdHlwZQBzeW1fbmFtZQAvc3dhcABmdW5jdGlvbl90eXBlAC9icm9hZGNhc3RfaW5fZGltAHRyYW5zZm9ybV9pbmRpY2VzAHdpbmRvd19ib3VuZHMAZmxhc2hfYXR0ZW50aW9uX2tlcm5lbAAvbXVsAF9hcHBseV9tYXNrX2FuZF9zb2Z0X2NhcABmbGFzaF9hdHRlbnRpb25fa2VybmVsLjxsb2NhbHM+LmluaXQAX25leHRfbm9uemVybwAvaG9tZS9wdG91bG1lL2p1c3RhYnl0ZS90cHVfcGFsbGFzX3Bvc3QvLi9wYWxsYXNfa2VybmVsLnB5AHByZWRpY2F0ZQAvcmVwZWF0AC9hZGQAcGlwZWxpbmVfbW9kZQAvZ3QAL2NvbmQAZGltZW5zaW9uAG1haW4AdHJhbnNmb3JtXzAAdHJhbnNmb3JtXzEAdHJhbnNmb3JtXzIAdHJhbnNmb3JtXzMAdHJhbnNmb3JtXzQAdHJhbnNmb3JtXzUAdHJhbnNmb3JtXzYAdHJhbnNmb3JtXzcAL2VxAHRpbWVzAG9wZXJhbmRTZWdtZW50U2l6ZXMAc3RyaWRlcwAvZG90X2dlbmVyYWwAZGltZW5zaW9uX251bWJlcnMAdHJhbnNwb3NlX2xocwB0cmFuc3Bvc2VfcmhzAGtpbmQAcmVkdWN0aW9uX2RpbXMAL3N1YgAvZXhwAHN0YWJsZV9tb3NhaWMudmVyc2lvbgBzcGxhc2hfbWhhX2Z3ZF9lOTcwMTA3MABkaW1lbnNpb25fc2VtYW50aWNzAGl0ZXJhdGlvbl9ib3VuZHMAc2NhbGFyX3ByZWZldGNoAHNjcmF0Y2hfb3BlcmFuZHMAd2luZG93X3BhcmFtcwBfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkLjxsb2NhbHM+LnZfaW5kZXhfbWFwAF9zcGxhc2hfYXR0ZW50aW9uX2ZvcndhcmQAX3NwbGFzaF9hdHRlbnRpb25fY3VzdG9tAF9zcGxhc2hfYXR0ZW50aW9uAFNwbGFzaEF0dGVudGlvbktlcm5lbC5fX2NhbGxfXwBiZW5jaG1hcmtfa2VybmVsLjxsb2NhbHM+LnNwbGFzaF9hdHRlbnRpb25fa2VybmVsAGJlbmNobWFya19rZXJuZWwAPG1vZHVsZT4AX25leHRfbm9uemVyby48bG9jYWxzPi48bGFtYmRhPgBfc3BsYXNoX2F0dGVudGlvbl9mb3J3YXJkLjxsb2NhbHM+LmtfaW5kZXhfbWFwAC9kaXYAZmFzdG1hdGgAL3NjYW4AZmxhc2hfYXR0ZW50aW9uX2tlcm5lbC48bG9jYWxzPi5ydW4Ab3ZlcmZsb3dGbGFncwAvaW90YQAvZ2UAQ2F1c2FsTWFzay5fX2luaXRfXy48bG9jYWxzPi5jYXVzYWxfbWFza19mdW5jdGlvbgAvaG9tZS9wdG91bG1lL21pbmljb25kYTMvZW52cy92bGxtL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvamF4L2V4cGVyaW1lbnRhbC9wYWxsYXMvb3BzL3RwdS9zcGxhc2hfYXR0ZW50aW9uL3NwbGFzaF9hdHRlbnRpb25fbWFzay5weQAvcGppdAAvc2VsZWN0X24AL3JlZHVjZV9tYXgAL21heAAvcmVkdWNlX3N1bQA=", "serialization_format": 1, "needs_layout_passes": true}}


HloLiveRange (max 8):
  InstructionSequence:
    0:constant.5
    1:constant.4
    2:Arg_2.3
    3:Arg_1.2
    4:Arg_0.1
    5:iota.1
    6:splash_mha_fwd_e9701070.1
    7:get-tuple-element.0
  BufferLiveRange:
    constant.4{}:1-6
    constant.5{}:0-6
    Arg_0.1{}:0-8
    Arg_1.2{}:0-8
    Arg_2.3{}:0-8
    iota.1{}:5-6
    splash_mha_fwd_e9701070.1{}:6-7
    splash_mha_fwd_e9701070.1{0}:6-6
    splash_mha_fwd_e9701070.1{1}:6-6
    splash_mha_fwd_e9701070.1{2}:6-6
    splash_mha_fwd_e9701070.1{3}:6-8
  Live ranges at 6 (peak):
    Arg_0.1{}: 4194304 bytes (cumulative: 4194304 bytes)
    Arg_1.2{}: 4194304 bytes (cumulative: 8388608 bytes)
    Arg_2.3{}: 4194304 bytes (cumulative: 12582912 bytes)
    splash_mha_fwd_e9701070.1{3}: 4194304 bytes (cumulative: 16777216 bytes)
    iota.1{}: 1048576 bytes (cumulative: 17825792 bytes)
    splash_mha_fwd_e9701070.1{0}: 262144 bytes (cumulative: 18087936 bytes)
    splash_mha_fwd_e9701070.1{1}: 262144 bytes (cumulative: 18350080 bytes)
    splash_mha_fwd_e9701070.1{2}: 262144 bytes (cumulative: 18612224 bytes)
    splash_mha_fwd_e9701070.1{}: 32 bytes (cumulative: 18612256 bytes)
    constant.4{}: 16 bytes (cumulative: 18612272 bytes)
    constant.5{}: 16 bytes (cumulative: 18612288 bytes)
